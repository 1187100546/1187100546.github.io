<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>åˆ†ç»„å¯†ç DES | èŠ±èŠ±çš„blog | åšç§¯è–„å‘</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="å¯†ç å­¦">
    <meta name="description" content="å¯†ç å­¦ä¸­çš„DESåŠ å¯†ã€‚">
<meta name="keywords" content="å¯†ç å­¦">
<meta property="og:type" content="article">
<meta property="og:title" content="åˆ†ç»„å¯†ç DES">
<meta property="og:url" content="https://1187100546.github.io/2020/01/03/des/index.html">
<meta property="og:site_name" content="èŠ±èŠ±çš„blog">
<meta property="og:description" content="å¯†ç å­¦ä¸­çš„DESåŠ å¯†ã€‚">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://s2.ax1x.com/2020/01/12/loHUSg.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/01/12/loLkes.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/01/12/loLmWT.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/01/12/loL50s.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/01/12/loLxB9.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/01/12/loOAje.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/01/12/loXtMD.png">
<meta property="og:updated_time" content="2020-01-12T10:16:59.773Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="åˆ†ç»„å¯†ç DES">
<meta name="twitter:description" content="å¯†ç å­¦ä¸­çš„DESåŠ å¯†ã€‚">
<meta name="twitter:image" content="https://s2.ax1x.com/2020/01/12/loHUSg.png">
    
        <link rel="alternate" type="application/atom+xml" title="èŠ±èŠ±çš„blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">huahua</h5>
          <a href="mailto:1187100546@qq.com" title="1187100546@qq.com" class="mail">1187100546@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                å½’æ¡£
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                æ ‡ç­¾
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                åˆ†ç±»
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://https://github.com/1187100546" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-link"></i>
                å…³äº
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">åˆ†ç»„å¯†ç DES</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">åˆ†ç»„å¯†ç DES</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-01-03T09:02:50.000Z" itemprop="datePublished" class="page-time">
  2020-01-03
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/å¯†ç å­¦/">å¯†ç å­¦</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#desç®—æ³•åŸç†"><span class="post-toc-number">1.</span> <span class="post-toc-text"> DESç®—æ³•åŸç†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#åŸºæœ¬ç»“æ„"><span class="post-toc-number">1.1.</span> <span class="post-toc-text"> åŸºæœ¬ç»“æ„</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å¯†é’¥æ‰©å±•"><span class="post-toc-number">1.2.</span> <span class="post-toc-text"> å¯†é’¥æ‰©å±•</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#få‡½æ•°"><span class="post-toc-number">1.3.</span> <span class="post-toc-text"> Få‡½æ•°</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä»£ç å®ç°"><span class="post-toc-number">2.</span> <span class="post-toc-text"> ä»£ç å®ç°</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å¯†é’¥æ‰©å±•-2"><span class="post-toc-number">2.1.</span> <span class="post-toc-text"> å¯†é’¥æ‰©å±•</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#få‡½æ•°-2"><span class="post-toc-number">2.2.</span> <span class="post-toc-text"> Få‡½æ•°</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ipç½®æ¢ä¸ipé€†ç½®æ¢"><span class="post-toc-number">2.3.</span> <span class="post-toc-text"> IPç½®æ¢ä¸IPé€†ç½®æ¢</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#åŠ è§£å¯†å°è£…"><span class="post-toc-number">2.4.</span> <span class="post-toc-text"> åŠ è§£å¯†å°è£…</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#è¿è¡Œç»“æœ"><span class="post-toc-number">3.</span> <span class="post-toc-text"> è¿è¡Œç»“æœ</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#cbcå·¥ä½œæ¨¡å¼desåŠ å¯†"><span class="post-toc-number">4.</span> <span class="post-toc-text"> CBCå·¥ä½œæ¨¡å¼DESåŠ å¯†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#è®¾è®¡æ€è·¯"><span class="post-toc-number">4.1.</span> <span class="post-toc-text"> è®¾è®¡æ€è·¯</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ä»£ç å®ç°-2"><span class="post-toc-number">4.2.</span> <span class="post-toc-text"> ä»£ç å®ç°</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#è¿è¡Œç»“æœ-2"><span class="post-toc-number">4.3.</span> <span class="post-toc-text"> è¿è¡Œç»“æœ</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#å®‰å…¨æ€§åˆ†æ"><span class="post-toc-number">5.</span> <span class="post-toc-text"> å®‰å…¨æ€§åˆ†æ</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#å®Œæ•´ä»£ç "><span class="post-toc-number">6.</span> <span class="post-toc-text"> å®Œæ•´ä»£ç </span></a></li></ol>
        </nav>
    </aside>


<article id="post-des"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">åˆ†ç»„å¯†ç DES</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-01-03 17:02:50" datetime="2020-01-03T09:02:50.000Z"  itemprop="datePublished">2020-01-03</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/å¯†ç å­¦/">å¯†ç å­¦</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>å¯†ç å­¦ä¸­çš„DESåŠ å¯†ã€‚</p>
<a id="more"></a>
<h2 id="desç®—æ³•åŸç†"><a class="markdownIt-Anchor" href="#desç®—æ³•åŸç†"></a> DESç®—æ³•åŸç†</h2>
<h3 id="åŸºæœ¬ç»“æ„"><a class="markdownIt-Anchor" href="#åŸºæœ¬ç»“æ„"></a> åŸºæœ¬ç»“æ„</h3>
<p>DESæ˜¯åˆ†ç»„åŠ å¯†ï¼Œå°†æ˜æ–‡åˆ†æˆ64ä½ä¸€ç»„ï¼Œå¯†é’¥é•¿åº¦ 64 æ¯”ç‰¹ï¼ˆå…¶ä¸­æœ‰æ•ˆé•¿åº¦ä¸º 56 æ¯”ç‰¹ï¼‰ï¼Œ8 çš„å€æ•°ä½ä¸ºå¥‡æ ¡éªŒä½ï¼ˆä¿è¯æ¯ 8 ä½æœ‰å¥‡æ•°ä¸ª 1ï¼‰ã€‚</p>
<p>å¦‚å›¾ï¼Œ64 æ¯”ç‰¹çš„å¯†é’¥ç»è¿‡ç½®æ¢é€‰æ‹©å’Œå¾ªç¯ç§»ä½æ“ä½œå¯ç”Ÿæˆ 16 ä¸ª 48 æ¯”ç‰¹çš„å­å¯†é’¥ã€‚æ˜æ–‡ m ç»è¿‡åˆå§‹ç½®æ¢ IP ååˆ’åˆ†ä¸ºå·¦å³ä¸¤éƒ¨åˆ†ï¼ˆå„32 æ¯”ç‰¹ï¼‰ï¼Œç»è¿‡ 16 è½® Feistel ç»“æœï¼ˆå…¶ä¸­æœ€åä¸€è½®ä¸åšå·¦å³äº¤æ¢ï¼‰å†åšä¸€æ¬¡é€†ç½®æ¢ IP-1å¾—åˆ°å¯†æ–‡ c ã€‚</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://s2.ax1x.com/2020/01/12/loHUSg.png" alt="loHUSg.png" title>
                </div>
                <div class="image-caption">loHUSg.png</div>
            </figure>
<p>åŠ å¯†æ–¹ç¨‹ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><msub><mi>R</mi><mn>0</mn></msub><mo>â†</mo><mi>I</mi><mi>P</mi><mspace linebreak="newline"></mspace><msub><mi>L</mi><mi>n</mi></msub><mo>â†</mo><msub><mi>R</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mspace linebreak="newline"></mspace><msub><mi>R</mi><mi>n</mi></msub><mo>â†</mo><msub><mi>L</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>âŠ•</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>R</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>K</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>c</mi><mo>=</mo><mo>â†</mo><mi>I</mi><msup><mi>P</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">L_0R_0 \leftarrow IP\\
L_n\leftarrow R_{n-1}\\
R_n\leftarrow L_{n-1}\oplus f(R_{n-1},K_n)\\
c=\leftarrow IP^{-1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>è§£å¯†æ–¹ç¨‹ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>16</mn></msub><msub><mi>L</mi><mn>16</mn></msub><mo>â†</mo><mi>I</mi><mi>P</mi><mspace linebreak="newline"></mspace><msub><mi>R</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>â†</mo><msub><mi>L</mi><mi>n</mi></msub><mspace linebreak="newline"></mspace><msub><mi>L</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>â†</mo><msub><mi>R</mi><mi>n</mi></msub><mo>âŠ•</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>L</mi><mi>n</mi></msub><msub><mi>K</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>m</mi><mo>=</mo><mi>I</mi><msup><mi>P</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">R_{16}L_{16}\leftarrow IP\\
R_{n-1}\leftarrow L_n\\
L_{n-1}\leftarrow R_n\oplus f(L_nK_n)\\
m=IP^{-1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>ç”±æ­¤å¯è§DESæ˜¯ä¸€ä¸ªå¯¹åˆè¿ç®—ã€‚</p>
<h3 id="å¯†é’¥æ‰©å±•"><a class="markdownIt-Anchor" href="#å¯†é’¥æ‰©å±•"></a> å¯†é’¥æ‰©å±•</h3>
<p>ç”¨äºç”Ÿæˆè¿­ä»£çš„å­å¯†é’¥ã€‚å…·ä½“è¿‡ç¨‹ä¸ºï¼š</p>
<p>64ä½åˆå§‹å¯†é’¥ç»è¿‡ç½®æ¢é€‰æ‹©1 ( PC-1 ) åå˜æˆ 56 ä½ï¼Œç»è¿‡å¾ªç¯å·¦ç§»å’Œç½®æ¢é€‰æ‹©2 ( PC-2 ) ååˆ†åˆ«å¾—åˆ° 16 ä¸ª 48 ä½å­å¯†é’¥ Ki ç”¨åšæ¯ä¸€è½®çš„è¿­ä»£è¿ç®—ã€‚</p>
<p>PC-1 å»æ‰äº†æ ¡éªŒä½ï¼Œ PC-2 å»æ‰äº†9, 18, 22, 25, 35, 38, 43, 54 ä½ã€‚</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://s2.ax1x.com/2020/01/12/loLkes.png" alt="loLkes.png" title>
                </div>
                <div class="image-caption">loLkes.png</div>
            </figure>
<h3 id="få‡½æ•°"><a class="markdownIt-Anchor" href="#få‡½æ•°"></a> Få‡½æ•°</h3>
<ul>
<li>
<p>å…ˆè¿›è¡ŒE-æ‰©å±•ï¼š32æ¯”ç‰¹æ‰©å±•ä¸º48æ¯”ç‰¹</p>
</li>
<li>
<p>å°†Eç›’æ‰©å±•å¾—åˆ°çš„48ä½è¾“å‡ºä¸å­å¯†é’¥ğ¾ğ‘–è¿›è¡Œå¼‚æˆ–è¿ç®—</p>
</li>
<li>
<p>lå‹ç¼©æ›¿æ¢S-ç›’ï¼Œç”±8ä¸ªS-ç›’æ„æˆ, æ¯ä¸ªS-ç›’éƒ½æ˜¯6æ¯”ç‰¹çš„è¾“å…¥ï¼Œ4æ¯”ç‰¹çš„è¾“å‡º</p>
</li>
<li>
<p>P-ç½®æ¢å¯¹8ä¸ªS-ç›’çš„è¾“å‡ºè¿›è¡Œå˜æ¢</p>
</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://s2.ax1x.com/2020/01/12/loLmWT.png" alt="loLmWT.png" title>
                </div>
                <div class="image-caption">loLmWT.png</div>
            </figure>
<h2 id="ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#ä»£ç å®ç°"></a> ä»£ç å®ç°</h2>
<h3 id="å¯†é’¥æ‰©å±•-2"><a class="markdownIt-Anchor" href="#å¯†é’¥æ‰©å±•-2"></a> å¯†é’¥æ‰©å±•</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#PC-1ç›’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_change_1</span><span class="params">(st)</span>:</span></span><br><span class="line">    key1_list = [<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>]</span><br><span class="line">    <span class="comment">#å¾—åˆ°56ä½ï¼Œå»æ‰æ ¡éªŒä½</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> key1_list:</span><br><span class="line">        res+=st[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#PC-2ç›’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_change_2</span><span class="params">(st)</span>:</span></span><br><span class="line">    key2_list = [<span class="number">14</span>,<span class="number">17</span>,<span class="number">11</span>,<span class="number">24</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">28</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">21</span>,<span class="number">10</span>,<span class="number">23</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">26</span>,<span class="number">8</span>,<span class="number">16</span>,<span class="number">7</span>,<span class="number">27</span>,<span class="number">20</span>,<span class="number">13</span>,<span class="number">2</span>,<span class="number">41</span>,<span class="number">52</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">47</span>,<span class="number">55</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">51</span>,<span class="number">45</span>,<span class="number">33</span>,<span class="number">48</span>,<span class="number">44</span>,<span class="number">49</span>,<span class="number">39</span>,<span class="number">56</span>,<span class="number">34</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">42</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">29</span>,<span class="number">32</span>]</span><br><span class="line">    <span class="comment">#å‹ç¼©ç½®æ¢</span></span><br><span class="line">    <span class="comment">#å»æ‰9ï¼Œ18ï¼Œ22ï¼Œ25ï¼Œ35ï¼Œ38ï¼Œ43ï¼Œ54ä½å¾—åˆ°48ä½</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> key2_list:</span><br><span class="line">        res+=st[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#16è½®è¿­ä»£ç”Ÿæˆå­å¯†é’¥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_gen</span><span class="params">(st)</span>:</span></span><br><span class="line">    key_list = []<span class="comment">#å­å¯†é’¥è¡¨</span></span><br><span class="line">    key_change_res = key_change_1(st)</span><br><span class="line">    <span class="comment">#PC-1ç½®æ¢åˆ†æˆCï¼ŒDä¸¤å—</span></span><br><span class="line">    key_c = key_change_res[<span class="number">0</span>:<span class="number">28</span>]</span><br><span class="line">    key_d = key_change_res[<span class="number">28</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">17</span>): <span class="comment">#å…±16è½®</span></span><br><span class="line">        <span class="keyword">if</span> (i==<span class="number">1</span>) <span class="keyword">or</span> (i==<span class="number">2</span>) <span class="keyword">or</span> (i==<span class="number">9</span>) <span class="keyword">or</span> (i==<span class="number">16</span>):<span class="comment">#æŒ‰è½®æ•°å¾ªç¯å·¦ç§»</span></span><br><span class="line">            key_c = zuoyiwei(key_c,<span class="number">1</span>)</span><br><span class="line">            key_d = zuoyiwei(key_d,<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            key_c = zuoyiwei(key_c,<span class="number">2</span>)</span><br><span class="line">            key_d = zuoyiwei(key_d,<span class="number">2</span>)</span><br><span class="line">        key_yiwei = key_c+key_d</span><br><span class="line">        <span class="comment">#å‹ç¼©ç½®æ¢</span></span><br><span class="line">        key_res = key_change_2(key_yiwei)</span><br><span class="line">        key_list.append(key_res)</span><br><span class="line"><span class="keyword">return</span> key_list</span><br></pre></td></tr></table></figure>
<h3 id="få‡½æ•°-2"><a class="markdownIt-Anchor" href="#få‡½æ•°-2"></a> Få‡½æ•°</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Eç›’æ‰©å±•ç½®æ¢ï¼Œå°†32ä½è¾“å‡ºæ‰©å±•è‡³48ä½</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box_e</span><span class="params">(st)</span>:</span></span><br><span class="line">    <span class="comment">#Eç›’ç½®æ¢è¡¨</span></span><br><span class="line">    e_list = [<span class="number">32</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">1</span>]</span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> e_list:</span><br><span class="line">        res +=st[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#Sç›’ä»£æ¢ç›’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box_s</span><span class="params">(st)</span>:</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="comment">#8ä¸ªSç›’ä»£æ¢è¡¨</span></span><br><span class="line">    s_list = [[<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>],</span><br><span class="line">              [<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>],</span><br><span class="line">              [<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>],</span><br><span class="line">              [<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>],</span><br><span class="line">              [<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>],</span><br><span class="line">              [<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>],</span><br><span class="line">              [<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>],</span><br><span class="line">              [<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>]]</span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(st),<span class="number">6</span>):<span class="comment">#6ä½è¾“å…¥ï¼Œ4ä½è¾“å‡º</span></span><br><span class="line">        begin_s = st[i:i+<span class="number">6</span>]</span><br><span class="line">        row = int(begin_s[<span class="number">0</span>]+begin_s[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">        col = int(begin_s[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">        num = bin(s_list[j][row*<span class="number">16</span>+col])[<span class="number">2</span>:]</span><br><span class="line">        <span class="keyword">for</span> padd <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">4</span>-len(num)):</span><br><span class="line">            num = <span class="string">"0"</span>+num</span><br><span class="line">        res += num</span><br><span class="line">        j = j+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#Pç›’ç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box_p</span><span class="params">(st)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    p_list = [<span class="number">16</span>,<span class="number">7</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">28</span>,<span class="number">17</span>,<span class="number">1</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">26</span>,<span class="number">5</span>,<span class="number">18</span>,<span class="number">31</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">24</span>,<span class="number">14</span>,<span class="number">32</span>,<span class="number">27</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">19</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">25</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> p_list:</span><br><span class="line">        res +=st[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#å°è£…æˆFå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">funcF</span><span class="params">(st,key)</span>:</span></span><br><span class="line">    str_e_res = box_e(st)</span><br><span class="line">    xor_res = xor(str_e_res,key)</span><br><span class="line">    str_s_res = box_s(xor_res)</span><br><span class="line">    str_p_res = box_p(str_s_res)</span><br><span class="line">    <span class="keyword">return</span> str_p_res</span><br></pre></td></tr></table></figure>
<h3 id="ipç½®æ¢ä¸ipé€†ç½®æ¢"><a class="markdownIt-Anchor" href="#ipç½®æ¢ä¸ipé€†ç½®æ¢"></a> IPç½®æ¢ä¸IPé€†ç½®æ¢</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åˆå§‹IPç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">begin_change</span><span class="params">(st)</span>:</span></span><br><span class="line">    <span class="comment">#ç½®æ¢è¡¨</span></span><br><span class="line">    change_list = [<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>]</span><br><span class="line">    res =<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> change_list:</span><br><span class="line">        res+=st[i<span class="number">-1</span>] <span class="comment">#å› ä¸ºåˆ—è¡¨æ˜¯1-64ï¼Œè€Œæ•°ç»„æ˜¯0-63ï¼Œæ‰€ä»¥å‡ä¸€</span></span><br><span class="line"><span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#IPé€†ç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mov_IP</span><span class="params">(st)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    ip_list = [<span class="number">40</span>,<span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>,<span class="number">64</span>,<span class="number">32</span>,<span class="number">39</span>,<span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,<span class="number">38</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,<span class="number">37</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,<span class="number">36</span>,<span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,<span class="number">35</span>,<span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,<span class="number">34</span>,<span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span>,<span class="number">26</span>,<span class="number">33</span>,<span class="number">1</span>,<span class="number">41</span>,<span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ip_list:</span><br><span class="line">        res += st[i<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="åŠ è§£å¯†å°è£…"><a class="markdownIt-Anchor" href="#åŠ è§£å¯†å°è£…"></a> åŠ è§£å¯†å°è£…</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">åŠ å¯†ï¼š</span><br><span class="line"><span class="comment">#å°è£…64ä½åŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESenc_test</span><span class="params">(mes,key)</span>:</span></span><br><span class="line">    mes_bin = strtobin(mes)<span class="comment">#æ˜æ–‡è½¬äºŒè¿›åˆ¶</span></span><br><span class="line">    mes_IP = begin_change(mes_bin)<span class="comment">#IPç½®æ¢</span></span><br><span class="line">    key_bin = strtobin(key)<span class="comment">#å¯†é’¥è½¬äºŒè¿›åˆ¶</span></span><br><span class="line">    key_list = key_gen(key_bin)<span class="comment">#ç”Ÿæˆå­å¯†é’¥</span></span><br><span class="line">    mes_left = mes_IP[<span class="number">0</span>:<span class="number">32</span>]<span class="comment">#æ˜æ–‡åˆ†ä¸¤ç»„32ä½</span></span><br><span class="line">    mes_right = mes_IP[<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">15</span>):<span class="comment">#16è½®Få‡½æ•°è¿­ä»£</span></span><br><span class="line">        mes_tmp = mes_right</span><br><span class="line">        right_f_res = funcF(mes_right,key_list[i])</span><br><span class="line">        mes_right = xor(right_f_res,mes_left)</span><br><span class="line">        mes_left = mes_tmp</span><br><span class="line">    fin_right = mes_right</span><br><span class="line">    fin_left = xor(funcF(mes_right,key_list[<span class="number">15</span>]),mes_left)</span><br><span class="line">    fin = fin_left+fin_right</span><br><span class="line">    fin = mov_IP(fin)<span class="comment">#IPé€†ç½®æ¢</span></span><br><span class="line"><span class="keyword">return</span> fin<span class="comment">#è¿”å›å¯†æ–‡</span></span><br><span class="line">è§£å¯†ï¼š</span><br><span class="line"><span class="comment">#å°è£…64ä½è§£å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESdec_test</span><span class="params">(cipher,key)</span>:</span>  <span class="comment">#å¯†æ–‡ç›´æ¥è¾“64ä½2è¿›åˆ¶</span></span><br><span class="line">    <span class="comment">#cipher = strtobin(str)</span></span><br><span class="line">    key_bin = strtobin(key)</span><br><span class="line">    key_list = key_gen(key_bin)</span><br><span class="line">    cipher = begin_change(cipher)</span><br><span class="line">    i = <span class="number">15</span></span><br><span class="line">    cipher_left = cipher[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line">    cipher_right = cipher[<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">while</span> i&gt;<span class="number">0</span>:</span><br><span class="line">        cipher_tmp = cipher_right</span><br><span class="line">        cipher_right = xor(cipher_left,funcF(cipher_right,key_list[i]))</span><br><span class="line">        cipher_left = cipher_tmp</span><br><span class="line">        i = i <span class="number">-1</span></span><br><span class="line">    fin_left = xor(cipher_left,funcF(cipher_right,key_list[<span class="number">0</span>]))</span><br><span class="line">    fin_right = cipher_right</span><br><span class="line">    fin = fin_left+fin_right</span><br><span class="line">    fin = mov_IP(fin)</span><br><span class="line">    my_plain = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(fin),<span class="number">8</span>):</span><br><span class="line">        my_plain += chr(int(fin[j:j+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line"><span class="keyword">return</span> my_plain</span><br></pre></td></tr></table></figure>
<h2 id="è¿è¡Œç»“æœ"><a class="markdownIt-Anchor" href="#è¿è¡Œç»“æœ"></a> è¿è¡Œç»“æœ</h2>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://s2.ax1x.com/2020/01/12/loL50s.png" alt="loL50s.png" title>
                </div>
                <div class="image-caption">loL50s.png</div>
            </figure>
<h2 id="cbcå·¥ä½œæ¨¡å¼desåŠ å¯†"><a class="markdownIt-Anchor" href="#cbcå·¥ä½œæ¨¡å¼desåŠ å¯†"></a> CBCå·¥ä½œæ¨¡å¼DESåŠ å¯†</h2>
<h3 id="è®¾è®¡æ€è·¯"><a class="markdownIt-Anchor" href="#è®¾è®¡æ€è·¯"></a> è®¾è®¡æ€è·¯</h3>
<p>å¯¹äºDESåˆ†ç»„åŠ å¯†ï¼Œæ¯æ¬¡åŠ å¯†å®Œçš„ç»“æœä¸ä¸‹ä¸€ç»„çš„æ˜æ–‡è¿›è¡Œå¼‚æˆ–ï¼Œè¿™å°±æ˜¯CBCï¼ˆå¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ï¼‰ã€‚</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://s2.ax1x.com/2020/01/12/loLxB9.png" alt="loLxB9.png" title>
                </div>
                <div class="image-caption">loLxB9.png</div>
            </figure>
<h3 id="ä»£ç å®ç°-2"><a class="markdownIt-Anchor" href="#ä»£ç å®ç°-2"></a> ä»£ç å®ç°</h3>
<p>è¿™é‡Œé‡‡ç”¨çš„åˆå§‹å‘é‡æ˜¯â€œaaaaaaaaâ€.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#cbcæ¨¡å¼ä¸‹åŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cbc_desenc</span><span class="params">(mes,key)</span>:</span></span><br><span class="line">    IV=<span class="string">"aaaaaaaa"</span></span><br><span class="line">    res=<span class="string">""</span></span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    cns=<span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> mes[i:i+<span class="number">8</span>]!=<span class="string">""</span>:</span><br><span class="line">        <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">            res+=DESenc_test(bintostr(xor(strtobin(IV),strtobin(mes[i:i+<span class="number">8</span>]))),key)</span><br><span class="line">            cns=DESenc_test(bintostr(xor(strtobin(IV),strtobin(mes[i:i+<span class="number">8</span>]))),key)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res+=DESenc_test(bintostr(xor(cns,strtobin(mes[i:i+<span class="number">8</span>]))),key)</span><br><span class="line">            cns=DESenc_test(bintostr(xor(cns,strtobin(mes[i:i+<span class="number">8</span>]))),key)</span><br><span class="line">        i=i+<span class="number">8</span></span><br><span class="line"><span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#cbcæ¨¡å¼ä¸‹è§£å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cbc_desdec</span><span class="params">(cipher,key)</span>:</span></span><br><span class="line">    res=<span class="string">""</span></span><br><span class="line">    IV=<span class="string">"aaaaaaaa"</span></span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    cns=<span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> cipher[i:i+<span class="number">64</span>]!=<span class="string">""</span>:</span><br><span class="line">        <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">            res+=bintostr(xor(strtobin(DESdec_test(cipher[i:i+<span class="number">64</span>],key)),strtobin(IV)))</span><br><span class="line">            cns=cipher[i:i+<span class="number">64</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res+=bintostr(xor(strtobin(DESdec_test(cipher[i:i+<span class="number">64</span>],key)),cns))</span><br><span class="line">            cns=cipher[i:i+<span class="number">64</span>]</span><br><span class="line">        i=i+<span class="number">64</span></span><br><span class="line"><span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h3 id="è¿è¡Œç»“æœ-2"><a class="markdownIt-Anchor" href="#è¿è¡Œç»“æœ-2"></a> è¿è¡Œç»“æœ</h3>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://s2.ax1x.com/2020/01/12/loOAje.png" alt="loOAje.png" title>
                </div>
                <div class="image-caption">loOAje.png</div>
            </figure>
<h2 id="å®‰å…¨æ€§åˆ†æ"><a class="markdownIt-Anchor" href="#å®‰å…¨æ€§åˆ†æ"></a> å®‰å…¨æ€§åˆ†æ</h2>
<p>å®‰å…¨æ€§äº‰è®ºï¼š</p>
<ul>
<li>
<p>Sç›’çš„è®¾è®¡å‡†åˆ™è¿˜æ²¡æœ‰å®Œå…¨å…¬å¼€ï¼Œäººä»¬ä»ç„¶ä¸çŸ¥é“Sç›’çš„æ„é€ ä¸­æ˜¯å¦ä½¿ç”¨äº†è¿›ä¸€æ­¥çš„è®¾è®¡å‡†åˆ™</p>
</li>
<li>
<p>DESå­˜åœ¨ä¸€äº›å¼±å¯†é’¥å’ŒåŠå¼±å¯†é’¥</p>
</li>
<li>
<p>DESçš„56ä½å¯†é’¥æ— æ³•æŠµæŠ—ç©·ä¸¾æ”»å‡»</p>
</li>
<li>
<p>ä»£æ•°ç»“æ„å­˜åœ¨äº’è¡¥å¯¹ç§°æ€§</p>
</li>
</ul>
<p>å¼±å¯†é’¥ï¼š</p>
<p>ç»™å®šåˆå§‹å¯†é’¥ğ¾ç”Ÿæˆå­å¯†é’¥æ—¶ï¼Œå°†ç§å­å¯†é’¥åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¦‚æœğ¾ä½¿å¾—è¿™ä¸¤éƒ¨åˆ†çš„æ¯ä¸€éƒ¨åˆ†çš„æ‰€æœ‰ä½ç½®å…¨ä¸º0æˆ–1ï¼Œåˆ™ç»å­å¯†é’¥äº§ç”Ÿå™¨äº§ç”Ÿçš„å„ä¸ªå­å¯†é’¥éƒ½ç›¸åŒï¼Œå³ğ¾1=ğ¾2=â€¦=ğ¾16ï¼Œåˆ™ç§°å¯†é’¥ğ¾ä¸ºå¼±å¯†é’¥ï¼ˆå…±æœ‰4ä¸ªï¼‰</p>
<p>è‹¥ğ¾ä¸ºå¼±å¯†é’¥ï¼Œåˆ™å¯¹ä»»æ„çš„64æ¯”ç‰¹ä¿¡æ¯æœ‰ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi mathvariant="normal">å’Œ</mi><msub><mi>D</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msub><mi>D</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">E_k(E_k(m))=må’ŒD_k(D_k(m))=m
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord cjk_fallback">å’Œ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span></span></p>
<p>åŠå¼±å¯†é’¥ï¼š</p>
<p>æŠŠæ˜æ–‡åŠ å¯†æˆç›¸åŒçš„å¯†æ–‡ï¼Œå³å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„å¯†é’¥ğ‘˜å’Œğ‘˜â€²,ä½¿å¾—ğ¸_ğ‘˜ (ğ‘š)=ğ¸_(ğ‘˜^â€² ) (ğ‘š)</p>
<p>å…·æœ‰ä¸‹è¿°æ€§è´¨ï¼š</p>
<p>è‹¥ğ‘˜å’Œğ‘˜â€²ä¸ºä¸€å¯¹å¼±å¯†é’¥ï¼Œğ‘šä¸ºæ˜æ–‡ç»„ï¼Œåˆ™æœ‰ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><msup><mi>k</mi><mo mathvariant="normal">â€²</mo></msup></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msub><mi>E</mi><msup><mi>k</mi><mo mathvariant="normal">â€²</mo></msup></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">E_{k&#x27;}(E_k(m))=E_k(E_{k&#x27;}(m))=m
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span></span></p>
<p>äº’è¡¥æ€§ï¼š</p>
<p>å¯¹æ˜æ–‡ğ‘šé€ä½å–è¡¥ï¼Œè®°ä¸ºğ‘š Ì…ï¼Œå¯†é’¥ğ¾é€ä½å–è¡¥ï¼Œè®°ä¸ºğ‘˜ Ì… ï¼Œ è‹¥ğ‘=ğ¸ğ‘˜(ğ‘š)ï¼Œåˆ™æœ‰ğ‘ Ì…=ğ¸_ğ‘˜ Ì… (ğ‘š Ì…) ï¼Œç§°ä¸ºç®—æ³•ä¸Šçš„äº’è¡¥æ€§</p>
<p>ç”±ç®—æ³•ä¸­ä¸¤æ¬¡å¼‚æˆ–è¿ç®—çš„é…ç½®å†³å®šï¼šä¸¤æ¬¡å¼‚æˆ–è¿ç®—ä¸€æ¬¡åœ¨Sç›’ä¹‹å‰ï¼Œä¸€æ¬¡åœ¨Pç›’ç½®æ¢ä¹‹å</p>
<p>è‹¥å¯¹DES çš„æ˜æ–‡å’Œå¯†é’¥åŒæ—¶å–è¡¥ï¼Œåˆ™æ‰©å±•è¿ç®—Eçš„è¾“å‡ºå’Œå­å¯†é’¥äº§ç”Ÿå™¨çš„è¾“å‡ºä¹Ÿéƒ½å–è¡¥ï¼Œå› è€Œç»å¼‚æˆ–è¿ç®—åçš„è¾“å‡ºå’Œæœªå–è¡¥æ—¶çš„è¾“å‡ºä¸€æ ·ï¼Œå³åˆ°è¾¾Sç›’çš„è¾“å…¥æ•°æ®æœªå˜ï¼Œè¾“å‡ºè‡ªç„¶ä¹Ÿä¸å˜ï¼Œä½†ç»ç¬¬äºŒä¸ªå¼‚æˆ–è¿ç®—æ—¶ï¼Œç”±äºå·¦è¾¹æ•°æ®å·²å–è¡¥ï¼Œå› è€Œè¾“å‡ºä¹Ÿå°±å–è¡¥</p>
<p>äº’è¡¥æ€§ä½¿DESåœ¨é€‰æ‹©æ˜æ–‡æ”»å‡»ä¸‹æ‰€éœ€çš„å·¥ä½œé‡å‡åŠï¼ˆ2^55ï¼‰</p>
<p>å¯¹é€‰æ‹©çš„æ˜æ–‡ğ‘šå’Œğ‘š Ì… åŠ å¯†åå¾—åˆ°å¯†æ–‡å¦‚ä¸‹ï¼š</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>c</mi><mn>2</mn></msub><mo>=</mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msup><mi>m</mi><mo>âˆ’</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_1=E_k(m)\\
c_2=E_k(m^-)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.071331em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">âˆ’</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>ç”±å¯¹ç§°äº’è¡¥æ€§å¯å¾—</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>c</mi><mn>2</mn><mo>âˆ’</mo></msubsup><mo>=</mo><msub><mi>E</mi><msup><mi>k</mi><mo>âˆ’</mo></msup></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_2^-=E_{k^-}(m)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.07777em;vertical-align:-0.256439em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">âˆ’</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.341865em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7026642857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">âˆ’</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></span></p>
<p>æ‰€ä»¥å¯¹ğ‘šåŠ å¯†ï¼Œå¦‚æœå¯†æ–‡ä¸ºğ‘_1ï¼Œåˆ™åŠ å¯†å¯†é’¥ä¸ºğ‘˜, å¦‚æœå¯†æ–‡ä¸º(ğ‘_2 ) Ì…ï¼Œåˆ™åŠ å¯†å¯†é’¥ä¸ºğ‘˜ Ì…</p>
<p>å·®åˆ†åˆ†ææ³•ï¼š</p>
<p>é€šè¿‡åˆ†æç‰¹å®šæ˜æ–‡å·®å¯¹ç»“æœå¯†æ–‡å·®çš„å½±å“æ¥è·å¾—å¯èƒ½æ€§æœ€å¤§çš„å¯†é’¥ã€‚è¿™ç§æ”»å‡»æ–¹æ³•ä¸»è¦é€‚ç”¨äºæ”»å‡»è¿­ä»£åˆ†ç»„å¯†ç ï¼Œæœ€åˆæ˜¯é’ˆå¯¹DESæå‡ºçš„ä¸€ç§æ”»å‡»æ–¹æ³•ï¼Œè™½ç„¶å·®åˆ†æ”»å‡»æ–¹æ³•å¯¹ç ´è¯‘16è½®çš„DESä¸èƒ½æä¾›ä¸€ç§å®ç”¨çš„æ–¹æ³•ï¼Œä½†å¯¹ç ´è¯‘è½®æ•°è¾ƒä½çš„DESæ˜¯å¾ˆæˆåŠŸçš„ã€‚</p>
<p>çº¿æ€§åˆ†ææ³•ï¼š</p>
<p>å¯»æ‰¾ä¸€ä¸ªç»™å®šå¯†ç ç®—æ³•çš„æœ‰å…³æ˜æ–‡æ¯”ç‰¹ã€å¯†æ–‡æ¯”ç‰¹å’Œå¯†é’¥æ¯”ç‰¹çš„æœ‰æ•ˆçº¿æ€§è¿‘ä¼¼è¡¨è¾¾å¼ï¼Œé€šè¿‡é€‰æ‹©å……åˆ†å¤šçš„æ˜ï¼å¯†æ–‡å¯¹æ¥åˆ†æå¯†é’¥çš„æŸäº›æ¯”ç‰¹ï¼Œç”¨è¿™ç§æ–¹æ³•ç ´è¯‘DESæ¯”å·®åˆ†åˆ†ææ–¹æ³•æ›´æœ‰æ•ˆã€‚å¯ç”¨247ä¸ªå·²çŸ¥æ˜æ–‡ç ´è¯‘8ï¼è½®DESã€‚</p>
<p>ä¸‰é‡DESï¼š</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://s2.ax1x.com/2020/01/12/loXtMD.png" alt="loXtMD.png" title>
                </div>
                <div class="image-caption">loXtMD.png</div>
            </figure>
<p>ä¸¤å¯†é’¥çš„3DESç§°ä¸ºåŠ å¯†-è§£å¯†-åŠ å¯†æ–¹æ¡ˆï¼Œç®€è®°ä¸ºEDE(encrypt-decrypt-encrypt)</p>
<p>ç ´è¯‘å®ƒçš„ç©·ä¸¾å¯†é’¥æœç´¢é‡ä¸º2<sup>112 </sup>é‡çº§ï¼Œç”¨å·®åˆ†åˆ†æç ´è¯‘ä¹Ÿè¦è¶…è¿‡10<sup>35</sup>sup&gt;é‡çº§ã€‚æ­¤æ–¹æ¡ˆä»æœ‰è¶³å¤Ÿçš„å®‰å…¨æ€§ã€‚</p>
<h2 id="å®Œæ•´ä»£ç "><a class="markdownIt-Anchor" href="#å®Œæ•´ä»£ç "></a> å®Œæ•´ä»£ç </h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#äºŒè¿›åˆ¶è½¬å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bintostr</span><span class="params">(st)</span>:</span></span><br><span class="line">    res=<span class="string">""</span></span><br><span class="line">    l=int(len(st)/<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(l):</span><br><span class="line">       res+=chr(int(st[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#å­—ç¬¦ä¸²è½¬äºŒè¿›åˆ¶</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">strtobin</span><span class="params">(st)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> st:</span><br><span class="line">        tmp = bin(ord(i))[<span class="number">2</span>:]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">8</span>-len(tmp)):</span><br><span class="line">            tmp = <span class="string">'0'</span>+tmp</span><br><span class="line">        res+=tmp</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#å¾ªç¯å·¦ç§»</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zuoyiwei</span><span class="params">(st,num)</span>:</span></span><br><span class="line">    my = st[num:len(st)]</span><br><span class="line">    my = my+st[<span class="number">0</span>:num]</span><br><span class="line">    <span class="keyword">return</span> my</span><br><span class="line"><span class="comment">#å¼‚æˆ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(str1,str2)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(str1)):</span><br><span class="line">        xor_res = int(str1[i],<span class="number">10</span>)^int(str2[i],<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">if</span> xor_res == <span class="number">1</span>:</span><br><span class="line">            res +=<span class="string">'1'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res +=<span class="string">'0'</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#PC-1ç›’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_change_1</span><span class="params">(st)</span>:</span></span><br><span class="line">    key1_list = [<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>]</span><br><span class="line">    <span class="comment">#å¾—åˆ°56ä½ï¼Œå»æ‰æ ¡éªŒä½</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> key1_list:</span><br><span class="line">        res+=st[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#PC-2ç›’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_change_2</span><span class="params">(st)</span>:</span></span><br><span class="line">    key2_list = [<span class="number">14</span>,<span class="number">17</span>,<span class="number">11</span>,<span class="number">24</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">28</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">21</span>,<span class="number">10</span>,<span class="number">23</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">26</span>,<span class="number">8</span>,<span class="number">16</span>,<span class="number">7</span>,<span class="number">27</span>,<span class="number">20</span>,<span class="number">13</span>,<span class="number">2</span>,<span class="number">41</span>,<span class="number">52</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">47</span>,<span class="number">55</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">51</span>,<span class="number">45</span>,<span class="number">33</span>,<span class="number">48</span>,<span class="number">44</span>,<span class="number">49</span>,<span class="number">39</span>,<span class="number">56</span>,<span class="number">34</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">42</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">29</span>,<span class="number">32</span>]</span><br><span class="line">    <span class="comment">#å‹ç¼©ç½®æ¢</span></span><br><span class="line">    <span class="comment">#å»æ‰9ï¼Œ18ï¼Œ22ï¼Œ25ï¼Œ35ï¼Œ38ï¼Œ43ï¼Œ54ä½å¾—åˆ°48ä½</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> key2_list:</span><br><span class="line">        res+=st[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#16è½®è¿­ä»£ç”Ÿæˆå­å¯†é’¥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_gen</span><span class="params">(st)</span>:</span></span><br><span class="line">    key_list = []<span class="comment">#å­å¯†é’¥è¡¨</span></span><br><span class="line">    key_change_res = key_change_1(st)</span><br><span class="line">    <span class="comment">#PC-1ç½®æ¢åˆ†æˆCï¼ŒDä¸¤å—</span></span><br><span class="line">    key_c = key_change_res[<span class="number">0</span>:<span class="number">28</span>]</span><br><span class="line">    key_d = key_change_res[<span class="number">28</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">17</span>): <span class="comment">#å…±16è½®</span></span><br><span class="line">        <span class="keyword">if</span> (i==<span class="number">1</span>) <span class="keyword">or</span> (i==<span class="number">2</span>) <span class="keyword">or</span> (i==<span class="number">9</span>) <span class="keyword">or</span> (i==<span class="number">16</span>):<span class="comment">#æŒ‰è½®æ•°å¾ªç¯å·¦ç§»</span></span><br><span class="line">            key_c = zuoyiwei(key_c,<span class="number">1</span>)</span><br><span class="line">            key_d = zuoyiwei(key_d,<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            key_c = zuoyiwei(key_c,<span class="number">2</span>)</span><br><span class="line">            key_d = zuoyiwei(key_d,<span class="number">2</span>)</span><br><span class="line">        key_yiwei = key_c+key_d</span><br><span class="line">        <span class="comment">#å‹ç¼©ç½®æ¢</span></span><br><span class="line">        key_res = key_change_2(key_yiwei)</span><br><span class="line">        key_list.append(key_res)</span><br><span class="line">    <span class="keyword">return</span> key_list</span><br><span class="line"><span class="comment">#åˆå§‹IPç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">begin_change</span><span class="params">(st)</span>:</span></span><br><span class="line">    <span class="comment">#ç½®æ¢è¡¨</span></span><br><span class="line">    change_list = [<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>]</span><br><span class="line">    res =<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> change_list:</span><br><span class="line">        res+=st[i<span class="number">-1</span>] <span class="comment">#å› ä¸ºåˆ—è¡¨æ˜¯1-64ï¼Œè€Œæ•°ç»„æ˜¯0-63ï¼Œæ‰€ä»¥å‡ä¸€</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#Eç›’æ‰©å±•ç½®æ¢ï¼Œå°†32ä½è¾“å‡ºæ‰©å±•è‡³48ä½</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box_e</span><span class="params">(st)</span>:</span></span><br><span class="line">    <span class="comment">#Eç›’ç½®æ¢è¡¨</span></span><br><span class="line">    e_list = [<span class="number">32</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">1</span>]</span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> e_list:</span><br><span class="line">        res +=st[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#Sç›’ä»£æ¢ç›’</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box_s</span><span class="params">(st)</span>:</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="comment">#8ä¸ªSç›’ä»£æ¢è¡¨</span></span><br><span class="line">    s_list = [[<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>],</span><br><span class="line">              [<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>],</span><br><span class="line">              [<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>],</span><br><span class="line">              [<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>],</span><br><span class="line">              [<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>],</span><br><span class="line">              [<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>],</span><br><span class="line">              [<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>],</span><br><span class="line">              [<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>]]</span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(st),<span class="number">6</span>):<span class="comment">#6ä½è¾“å…¥ï¼Œ4ä½è¾“å‡º</span></span><br><span class="line">        begin_s = st[i:i+<span class="number">6</span>]</span><br><span class="line">        row = int(begin_s[<span class="number">0</span>]+begin_s[<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">        col = int(begin_s[<span class="number">1</span>:<span class="number">5</span>],<span class="number">2</span>)</span><br><span class="line">        num = bin(s_list[j][row*<span class="number">16</span>+col])[<span class="number">2</span>:]</span><br><span class="line">        <span class="keyword">for</span> padd <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">4</span>-len(num)):</span><br><span class="line">            num = <span class="string">"0"</span>+num</span><br><span class="line">        res += num</span><br><span class="line">        j = j+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#Pç›’ç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box_p</span><span class="params">(st)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    p_list = [<span class="number">16</span>,<span class="number">7</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">28</span>,<span class="number">17</span>,<span class="number">1</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">26</span>,<span class="number">5</span>,<span class="number">18</span>,<span class="number">31</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">24</span>,<span class="number">14</span>,<span class="number">32</span>,<span class="number">27</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">19</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">25</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> p_list:</span><br><span class="line">        res +=st[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#å°è£…æˆFå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">funcF</span><span class="params">(st,key)</span>:</span></span><br><span class="line">    str_e_res = box_e(st)</span><br><span class="line">    xor_res = xor(str_e_res,key)</span><br><span class="line">    str_s_res = box_s(xor_res)</span><br><span class="line">    str_p_res = box_p(str_s_res)</span><br><span class="line">    <span class="keyword">return</span> str_p_res</span><br><span class="line"><span class="comment">#IPé€†ç½®æ¢</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mov_IP</span><span class="params">(st)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    ip_list = [<span class="number">40</span>,<span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>,<span class="number">64</span>,<span class="number">32</span>,<span class="number">39</span>,<span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,<span class="number">38</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,<span class="number">37</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,<span class="number">36</span>,<span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,<span class="number">35</span>,<span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,<span class="number">34</span>,<span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span>,<span class="number">26</span>,<span class="number">33</span>,<span class="number">1</span>,<span class="number">41</span>,<span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ip_list:</span><br><span class="line">        res += st[i<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#å°è£…64ä½åŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESenc_test</span><span class="params">(mes,key)</span>:</span></span><br><span class="line">    mes_bin = strtobin(mes)<span class="comment">#æ˜æ–‡è½¬äºŒè¿›åˆ¶</span></span><br><span class="line">    mes_IP = begin_change(mes_bin)<span class="comment">#IPç½®æ¢</span></span><br><span class="line">    key_bin = strtobin(key)<span class="comment">#å¯†é’¥è½¬äºŒè¿›åˆ¶</span></span><br><span class="line">    key_list = key_gen(key_bin)<span class="comment">#ç”Ÿæˆå­å¯†é’¥</span></span><br><span class="line">    mes_left = mes_IP[<span class="number">0</span>:<span class="number">32</span>]<span class="comment">#æ˜æ–‡åˆ†ä¸¤ç»„32ä½</span></span><br><span class="line">    mes_right = mes_IP[<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">15</span>):<span class="comment">#16è½®Få‡½æ•°è¿­ä»£</span></span><br><span class="line">        mes_tmp = mes_right</span><br><span class="line">        right_f_res = funcF(mes_right,key_list[i])</span><br><span class="line">        mes_right = xor(right_f_res,mes_left)</span><br><span class="line">        mes_left = mes_tmp</span><br><span class="line">    fin_right = mes_right</span><br><span class="line">    fin_left = xor(funcF(mes_right,key_list[<span class="number">15</span>]),mes_left)</span><br><span class="line">    fin = fin_left+fin_right</span><br><span class="line">    fin = mov_IP(fin)<span class="comment">#IPé€†ç½®æ¢</span></span><br><span class="line">    <span class="keyword">return</span> fin<span class="comment">#è¿”å›å¯†æ–‡</span></span><br><span class="line"><span class="comment">#Alice_bob</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESenc_ab</span><span class="params">(mes,key)</span>:</span></span><br><span class="line">    mes_bin = strtobin(mes)<span class="comment">#æ˜æ–‡è½¬äºŒè¿›åˆ¶</span></span><br><span class="line">    mes_IP = begin_change(mes_bin)<span class="comment">#IPç½®æ¢</span></span><br><span class="line">    key_bin = key<span class="comment">#å¯†é’¥è½¬äºŒè¿›åˆ¶</span></span><br><span class="line">    key_list = key_gen(key_bin)<span class="comment">#ç”Ÿæˆå­å¯†é’¥</span></span><br><span class="line">    mes_left = mes_IP[<span class="number">0</span>:<span class="number">32</span>]<span class="comment">#æ˜æ–‡åˆ†ä¸¤ç»„32ä½</span></span><br><span class="line">    mes_right = mes_IP[<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">15</span>):<span class="comment">#16è½®Få‡½æ•°è¿­ä»£</span></span><br><span class="line">        mes_tmp = mes_right</span><br><span class="line">        right_f_res = funcF(mes_right,key_list[i])</span><br><span class="line">        mes_right = xor(right_f_res,mes_left)</span><br><span class="line">        mes_left = mes_tmp</span><br><span class="line">    fin_right = mes_right</span><br><span class="line">    fin_left = xor(funcF(mes_right,key_list[<span class="number">15</span>]),mes_left)</span><br><span class="line">    fin = fin_left+fin_right</span><br><span class="line">    fin = mov_IP(fin)<span class="comment">#IPé€†ç½®æ¢</span></span><br><span class="line">    <span class="keyword">return</span> fin<span class="comment">#è¿”å›å¯†æ–‡</span></span><br><span class="line"><span class="comment">#å°è£…64ä½è§£å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESdec_test</span><span class="params">(cipher,key)</span>:</span>  <span class="comment">#å¯†æ–‡ç›´æ¥è¾“64ä½2è¿›åˆ¶</span></span><br><span class="line">    <span class="comment">#cipher = strtobin(str)</span></span><br><span class="line">    key_bin = strtobin(key)</span><br><span class="line">    key_list = key_gen(key_bin)</span><br><span class="line">    cipher = begin_change(cipher)</span><br><span class="line">    i = <span class="number">15</span></span><br><span class="line">    cipher_left = cipher[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line">    cipher_right = cipher[<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">while</span> i&gt;<span class="number">0</span>:</span><br><span class="line">        cipher_tmp = cipher_right</span><br><span class="line">        cipher_right = xor(cipher_left,funcF(cipher_right,key_list[i]))</span><br><span class="line">        cipher_left = cipher_tmp</span><br><span class="line">        i = i <span class="number">-1</span></span><br><span class="line">    fin_left = xor(cipher_left,funcF(cipher_right,key_list[<span class="number">0</span>]))</span><br><span class="line">    fin_right = cipher_right</span><br><span class="line">    fin = fin_left+fin_right</span><br><span class="line">    fin = mov_IP(fin)</span><br><span class="line">    my_plain = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(fin),<span class="number">8</span>):</span><br><span class="line">        my_plain += chr(int(fin[j:j+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> my_plain</span><br><span class="line"><span class="comment">#alice_bob</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESdec_ab</span><span class="params">(cipher,key)</span>:</span>  <span class="comment">#å¯†æ–‡ç›´æ¥è¾“64ä½2è¿›åˆ¶</span></span><br><span class="line">    <span class="comment">#cipher = strtobin(str)</span></span><br><span class="line">    key_bin = key</span><br><span class="line">    key_list = key_gen(key_bin)</span><br><span class="line">    cipher = begin_change(cipher)</span><br><span class="line">    i = <span class="number">15</span></span><br><span class="line">    cipher_left = cipher[<span class="number">0</span>:<span class="number">32</span>]</span><br><span class="line">    cipher_right = cipher[<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">while</span> i&gt;<span class="number">0</span>:</span><br><span class="line">        cipher_tmp = cipher_right</span><br><span class="line">        cipher_right = xor(cipher_left,funcF(cipher_right,key_list[i]))</span><br><span class="line">        cipher_left = cipher_tmp</span><br><span class="line">        i = i <span class="number">-1</span></span><br><span class="line">    fin_left = xor(cipher_left,funcF(cipher_right,key_list[<span class="number">0</span>]))</span><br><span class="line">    fin_right = cipher_right</span><br><span class="line">    fin = fin_left+fin_right</span><br><span class="line">    fin = mov_IP(fin)</span><br><span class="line">    my_plain = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(fin),<span class="number">8</span>):</span><br><span class="line">        my_plain += chr(int(fin[j:j+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> my_plain</span><br><span class="line"><span class="comment">#DESåŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESenc</span><span class="params">(mes,key)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> mes[i:i+<span class="number">8</span>] != <span class="string">""</span>:</span><br><span class="line">        res += DESenc_test(mes[i:i+<span class="number">8</span>],key)</span><br><span class="line">        i = i+<span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#alice_bob</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESenc_a</span><span class="params">(mes,key)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    res += DESenc_ab(mes,key)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#DESè§£å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESdec</span><span class="params">(cipher,key)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> cipher[i:i + <span class="number">64</span>] != <span class="string">""</span>:</span><br><span class="line">        res += DESdec_test(cipher[i:i + <span class="number">64</span>], key)</span><br><span class="line">        i = i + <span class="number">64</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#cbcæ¨¡å¼ä¸‹åŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cbc_desenc</span><span class="params">(mes,key)</span>:</span></span><br><span class="line">    IV=<span class="string">"aaaaaaaa"</span></span><br><span class="line">    res=<span class="string">""</span></span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    cns=<span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> mes[i:i+<span class="number">8</span>]!=<span class="string">""</span>:</span><br><span class="line">        <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">            res+=DESenc_test(bintostr(xor(strtobin(IV),strtobin(mes[i:i+<span class="number">8</span>]))),key)</span><br><span class="line">            cns=DESenc_test(bintostr(xor(strtobin(IV),strtobin(mes[i:i+<span class="number">8</span>]))),key)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res+=DESenc_test(bintostr(xor(cns,strtobin(mes[i:i+<span class="number">8</span>]))),key)</span><br><span class="line">            cns=DESenc_test(bintostr(xor(cns,strtobin(mes[i:i+<span class="number">8</span>]))),key)</span><br><span class="line">        i=i+<span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#cbcæ¨¡å¼ä¸‹è§£å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cbc_desdec</span><span class="params">(cipher,key)</span>:</span></span><br><span class="line">    res=<span class="string">""</span></span><br><span class="line">    IV=<span class="string">"aaaaaaaa"</span></span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    cns=<span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> cipher[i:i+<span class="number">64</span>]!=<span class="string">""</span>:</span><br><span class="line">        <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">            res+=bintostr(xor(strtobin(DESdec_test(cipher[i:i+<span class="number">64</span>],key)),strtobin(IV)))</span><br><span class="line">            cns=cipher[i:i+<span class="number">64</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res+=bintostr(xor(strtobin(DESdec_test(cipher[i:i+<span class="number">64</span>],key)),cns))</span><br><span class="line">            cns=cipher[i:i+<span class="number">64</span>]</span><br><span class="line">        i=i+<span class="number">64</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment">#main</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    m = input(<span class="string">"Please enter your plaintext:\n\t"</span>)</span><br><span class="line">    lm = len(m)</span><br><span class="line">    <span class="comment"># è‹¥ä¸æ˜¯8çš„å€æ•°ï¼Œåˆ™ç”¨0å¡«å……</span></span><br><span class="line">    lm_mod = lm % <span class="number">8</span></span><br><span class="line">    <span class="keyword">if</span> lm_mod != <span class="number">0</span>:</span><br><span class="line">        FillLength = <span class="number">8</span> - lm_mod</span><br><span class="line">        m += FillLength * <span class="string">"0"</span><span class="comment">#padding</span></span><br><span class="line">        lm += FillLength</span><br><span class="line">    k = input(<span class="string">"Please enter your key:\n\t"</span>)</span><br><span class="line">    c_t=bintostr(DESenc(m,k))</span><br><span class="line">    print(<span class="string">"DES:\n\t"</span>,c_t)</span><br><span class="line">    print(<span class="string">"CBC_DES:\n\t"</span>,bintostr(cbc_desenc(m,k)))</span><br><span class="line">    <span class="string">'''c = input("Please enter your ciphertext:\n\t")</span></span><br><span class="line"><span class="string">    k_1 = input("Please enter your key:\n\t")</span></span><br><span class="line"><span class="string">    print(DESdec(strtobin(c),k_1))'''</span></span><br><span class="line">    print(<span class="string">"DESè§£å¯†\n\t"</span>,DESdec(DESenc(m,k),k))</span><br><span class="line">    c2= input(<span class="string">"Please enter your cbc_ciphertext:\n\t"</span>)</span><br><span class="line">    k_2=input(<span class="string">"Please enter your key:\n\t"</span>)</span><br><span class="line">    print(cbc_desdec(cbc_desenc(m,k),k_2))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">main()</span><br><span class="line">å®éªŒå››</span><br><span class="line">RSAåŠ å¯†</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FastMod</span><span class="params">(x, n, m)</span>:</span></span><br><span class="line">    a = <span class="number">1</span></span><br><span class="line">    b = x</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        temp = n</span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">1</span> :</span><br><span class="line">            a = a * b % m</span><br><span class="line">        b = b * b % m</span><br><span class="line">        n = n//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> temp &lt; <span class="number">1</span> :</span><br><span class="line">            <span class="keyword">return</span> a</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">computeD</span><span class="params">(e, phi_n)</span>:</span></span><br><span class="line">    (x, y, r) = extendedGCD(phi_n, e)</span><br><span class="line">    <span class="keyword">if</span> y &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> phi_n + y</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extendedGCD</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1</span>, <span class="number">0</span>, a)</span><br><span class="line">    x1 = <span class="number">1</span></span><br><span class="line">    y1 = <span class="number">0</span></span><br><span class="line">    x2 = <span class="number">0</span></span><br><span class="line">    y2 = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">        q = a // b</span><br><span class="line">        r = a % b</span><br><span class="line">        a = b</span><br><span class="line">        b = r</span><br><span class="line">        x = x1 - q*x2</span><br><span class="line">        x1 = x2</span><br><span class="line">        x2 = x</span><br><span class="line">        y = y1 - q*y2</span><br><span class="line">        y1 = y2</span><br><span class="line">        y2 = y</span><br><span class="line">    <span class="keyword">return</span>(x1, y1, a)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2Hex</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>.join(<span class="string">"&#123;:02x&#125;"</span>.format(ord(x)) <span class="keyword">for</span> x <span class="keyword">in</span> m)</span><br><span class="line"><span class="comment"># ç´ æ€§æ£€éªŒï¼šé‡‡ç”¨ Miler-Rabin æ£€éªŒæ³•</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">miller_rabin</span><span class="params">(n,k=<span class="number">80</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">2</span> <span class="keyword">or</span> n == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    r, s = <span class="number">0</span>, n - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> s % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        r += <span class="number">1</span></span><br><span class="line">        s //= <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(k):</span><br><span class="line">        a = random.randrange(<span class="number">2</span>, n - <span class="number">1</span>)</span><br><span class="line">        x = pow(a, s, n)</span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">1</span> <span class="keyword">or</span> x == n - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(r - <span class="number">1</span>):</span><br><span class="line">            x = pow(x, <span class="number">2</span>, n)</span><br><span class="line">            <span class="keyword">if</span> x == n - <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="comment"># ç”Ÿæˆ b ä½çš„ç´ æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genPrime</span><span class="params">(b=<span class="number">1024</span>)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># the highest bit is 1</span></span><br><span class="line">        ans = <span class="string">"1"</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(b<span class="number">-2</span>):</span><br><span class="line">            ans += str(random.randint(<span class="number">0</span>,<span class="number">1</span>))</span><br><span class="line">        <span class="comment"># the lowest bit is 1</span></span><br><span class="line">        ans += <span class="string">"1"</span></span><br><span class="line">        ans = int(ans,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> miller_rabin(ans):</span><br><span class="line">            <span class="keyword">return</span> ans</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genE</span><span class="params">(phi_n)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        e = genPrime(b=random.randint(<span class="number">3</span>,<span class="number">13</span>))</span><br><span class="line">        <span class="keyword">if</span> e == <span class="number">3</span> <span class="keyword">or</span> e == <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> phi_n%e != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> e</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSAEncrypt</span><span class="params">(m,n,e)</span>:</span></span><br><span class="line">    m = int(str2Hex(m),<span class="number">16</span>)</span><br><span class="line">    c = pow(m,e,n)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSADecrypt</span><span class="params">(c,d,n)</span>:</span></span><br><span class="line">    m = pow(c,d,n)</span><br><span class="line">    m = bytes.fromhex(<span class="string">'&#123;:x&#125;'</span>.format(m))</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># ç”Ÿæˆä¸¤ä¸ªå¤§ç´ æ•°på’Œq</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"Generate p and q ......"</span>)</span><br><span class="line">    p = genPrime()</span><br><span class="line">    q = genPrime()</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"p = "</span>+str(p))</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"q = "</span>+str(q))</span><br><span class="line">    <span class="comment"># è®¡ç®—n = p*q</span></span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"n = "</span>+str(n))</span><br><span class="line">    <span class="comment"># è®¡ç®—Ï†(n) = p*q</span></span><br><span class="line">    phi_n = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"\nGenerate e ......"</span>)</span><br><span class="line">    <span class="comment"># ç”Ÿæˆä¸€ä¸ªå’ŒÏ†(n)äº’ç´ çš„æ•°e</span></span><br><span class="line">    e = genE(phi_n)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"e = "</span>+str(e))</span><br><span class="line">    m = <span class="string">"Hello world!"</span></span><br><span class="line">    <span class="comment"># åŠ å¯†ç®—æ³•</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"\n"</span>+<span class="number">8</span>*<span class="string">"*"</span>+<span class="string">" Encryption "</span>+<span class="number">8</span>*<span class="string">"*"</span>)</span><br><span class="line">    Ciphertext = RSAEncrypt(m,n,e)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"The Ciphertext is:\n\t"</span>+str(Ciphertext))</span><br><span class="line">    <span class="comment"># è§£å¯†ç®—æ³•</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"\n"</span>+<span class="number">8</span>*<span class="string">"*"</span>+<span class="string">" Decryption "</span>+<span class="number">8</span>*<span class="string">"*"</span>)</span><br><span class="line">    <span class="comment"># ä½¿ç”¨ç§é’¥dï¼Œdæ˜¯eæ¨¡Ï†(n)çš„é€†</span></span><br><span class="line">    d = computeD(e,phi_n)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"d = "</span>+str(d))</span><br><span class="line">    Plaintext = RSADecrypt(Ciphertext,d,n)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"The Plaintext is:\n\t"</span>+str(Plaintext))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2020-01-12T10:16:59.773Z" itemprop="dateUpdated">2020-01-12 18:16:59</time>
</span><br>


        
        è¿™é‡Œå¯ä»¥å†™ä½œè€…ç•™è¨€ï¼Œæ ‡ç­¾å’Œ hexo ä¸­æ‰€æœ‰å˜é‡åŠè¾…åŠ©å‡½æ•°ç­‰å‡å¯è°ƒç”¨ï¼Œç¤ºä¾‹ï¼š<a href="/2020/01/03/des/" target="_blank" rel="external">https://1187100546.github.io/2020/01/03/des/</a>
        
    </div>
    
    <footer>
        <a href="https://1187100546.github.io">
            <img src="/img/avatar.jpg" alt="huahua">
            huahua
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">èµ</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/å¯†ç å­¦/">å¯†ç å­¦</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://1187100546.github.io/2020/01/03/des/&title=ã€Šåˆ†ç»„å¯†ç DESã€‹ â€” èŠ±èŠ±çš„blog&pic=https://1187100546.github.io/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://1187100546.github.io/2020/01/03/des/&title=ã€Šåˆ†ç»„å¯†ç DESã€‹ â€” èŠ±èŠ±çš„blog&source=å¯†ç å­¦ä¸­çš„DESåŠ å¯†ã€‚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://1187100546.github.io/2020/01/03/des/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Šåˆ†ç»„å¯†ç DESã€‹ â€” èŠ±èŠ±çš„blog&url=https://1187100546.github.io/2020/01/03/des/&via=https://1187100546.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://1187100546.github.io/2020/01/03/des/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2020/01/12/RSA/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">å…¬é’¥å¯†ç RSA</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/01/03/lsfr/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">åºåˆ—å¯†ç </h4>
      </a>
    </div>
  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        è°¢è°¢å¤§çˆ·~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechatpay.png" alt="æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechatpay.png" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>huahua &copy; 2018 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://1187100546.github.io/2020/01/03/des/&title=ã€Šåˆ†ç»„å¯†ç DESã€‹ â€” èŠ±èŠ±çš„blog&pic=https://1187100546.github.io/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://1187100546.github.io/2020/01/03/des/&title=ã€Šåˆ†ç»„å¯†ç DESã€‹ â€” èŠ±èŠ±çš„blog&source=å¯†ç å­¦ä¸­çš„DESåŠ å¯†ã€‚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://1187100546.github.io/2020/01/03/des/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€Šåˆ†ç»„å¯†ç DESã€‹ â€” èŠ±èŠ±çš„blog&url=https://1187100546.github.io/2020/01/03/des/&via=https://1187100546.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://1187100546.github.io/2020/01/03/des/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKklEQVR42u3a22orMQwF0P7/T6fQp0IYZ0tKSsdefjoMk7FXDwhd/PUVr8fPSt75va6eX618r+bCwMC4LaP36asnz799fj//bXI2DAyMcxjrILsOgoXNnt5f75WcDQMDA6MXEOe/wsDAwJgE3CT5e9cTDAwMjGoRW0371vh1KfvBWhwDA+OGjOpg4C///cH5BgYGxk0Yj8HqjTMn4fXyJBgYGFsz1kVpHnzzQ+dlcPkSBgYGxtaM/AJEtXCdXMuoBmsMDIy9GfNispcyToLsi/8HDAyM7RjVwjIPx/kYYFLuYmBg7M1IjpsE1uTJZCARzWAxMDA2ZfRKymqbLH+nemnjcjCAgYGxNaOaUeZJZPKdCQ8DA2NXRn70CWB96EljrjD5xMDAuC2j2hpbJ4u9ZlyeMjbrcgwMjJsz5voP3v6oBlkMDIxNGb1RYr5ZNeBWr1xgYGCcyeiNNntttV7xfPlnxcDAOIaRNPeTIJh8c1IeY2BgnMyoHiIPvnlTrzkKxcDAOIBRvX7ag1Vbb/n3MTAwTmA0w1zMm6R9UasOAwNja0a19T8Zc1bDem+AgYGBsRPjUVx5m6xa0CZJ5GXox8DA2JpRDXa9RK03VMj3xcDAOIExGWH2rk0ke5UvqGFgYBzAmAfZ/FpYL/a/4GFgYGDEydx7w3EBj4GBgRFs9q56ujlIwMDAOICRF5bVpC2/GlsuXDEwMI5h9AYD86NM0s23jTAxMDD+O+MbaI9gvsP57R8AAAAASUVORK5CYII=" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'æ­»é¬¼å»å“ªé‡Œäº†ï¼';
            clearTimeout(titleTime);
        } else {
            document.title = '(ã¤ã‚§âŠ‚)å’¦!åˆå¥½äº†!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>

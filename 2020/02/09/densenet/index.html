<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>DenseNetç¥ç»ç½‘ç»œç»“æ„ | èŠ±èŠ±çš„blog | åšç§¯è–„å‘</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Deep Learning,ç¥ç»ç½‘ç»œ,DenseNet">
    <meta name="description" content="CVPR 2017æœ€ä½³è®ºæ–‡DenseNetï¼Œè®ºæ–‡ä¸­æå‡ºçš„DenseNetï¼ˆDense Convolutional Networkï¼‰ ã€‚">
<meta name="keywords" content="Deep Learning,ç¥ç»ç½‘ç»œ,DenseNet">
<meta property="og:type" content="article">
<meta property="og:title" content="DenseNetç¥ç»ç½‘ç»œç»“æ„">
<meta property="og:url" content="https://1187100546.github.io/2020/02/09/densenet/index.html">
<meta property="og:site_name" content="èŠ±èŠ±çš„blog">
<meta property="og:description" content="CVPR 2017æœ€ä½³è®ºæ–‡DenseNetï¼Œè®ºæ–‡ä¸­æå‡ºçš„DenseNetï¼ˆDense Convolutional Networkï¼‰ ã€‚">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://s2.ax1x.com/2020/02/09/1foPQe.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/02/09/1foX6g.png">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5C%5Cx_l+%3D+H_l%28x_%7Bl-1%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5C%5Cx_l+%3D+H_l%28x_%7Bl-1%7D%29+%2B+x_%7Bl-1%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5C%5Cx_l+%3D+H_l%28%5Bx_0%2C+x_1%2C+...%2C+x_%7Bl-1%7D%5D%29">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-0b28a49f274da9bd8dec2dccddf1ec53_hd.jpg">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-7114e1583347944ea287b9552202b0ab_hd.jpg">
<meta property="og:image" content="https://pic1.zhimg.com/v2-4de2c07f516b030b864181c79734dc8c_r.jpg">
<meta property="og:image" content="https://pic1.zhimg.com/80/v2-c712b7a04200ecfd05c79478adb18888_hd.jpg">
<meta property="og:image" content="https://s2.ax1x.com/2020/02/09/1fbO5n.png">
<meta property="og:updated_time" content="2020-02-09T08:13:48.517Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DenseNetç¥ç»ç½‘ç»œç»“æ„">
<meta name="twitter:description" content="CVPR 2017æœ€ä½³è®ºæ–‡DenseNetï¼Œè®ºæ–‡ä¸­æå‡ºçš„DenseNetï¼ˆDense Convolutional Networkï¼‰ ã€‚">
<meta name="twitter:image" content="https://s2.ax1x.com/2020/02/09/1foPQe.png">
    
        <link rel="alternate" type="application/atom+xml" title="èŠ±èŠ±çš„blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/hua.jpg">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <link rel="stylesheet" href="/css/prism/prism-tomorrow-night.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-list-ul"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/OIP.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">huahua</h5>
          <a href="mailto:1187100546@qq.com" title="1187100546@qq.com" class="mail">1187100546@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives/"  >
                <i class="icon icon-lg icon-archives"></i>
                å½’æ¡£
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/"  >
                <i class="icon icon-lg icon-th-list"></i>
                åˆ†ç±»
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/"  >
                <i class="icon icon-lg icon-tags"></i>
                æ ‡ç­¾
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/1187100546"  >
                <i class="icon icon-lg icon-github"></i>
                github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/warframe/"  >
                <i class="icon icon-lg icon-gamepad"></i>
                warframe
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about/"  >
                <i class="icon icon-lg icon-info-circle"></i>
                å…³äº
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">DenseNetç¥ç»ç½‘ç»œç»“æ„</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">DenseNetç¥ç»ç½‘ç»œç»“æ„</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-02-09T05:52:33.000Z" itemprop="datePublished" class="page-time">
  2020-02-09
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä¼˜ç‚¹"><span class="post-toc-number">1.</span> <span class="post-toc-text">ä¼˜ç‚¹</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#è®¾è®¡ç†å¿µ"><span class="post-toc-number">2.</span> <span class="post-toc-text">è®¾è®¡ç†å¿µ</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ç½‘ç»œç»“æ„"><span class="post-toc-number">3.</span> <span class="post-toc-text">ç½‘ç»œç»“æ„</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä»£ç å®ç°"><span class="post-toc-number">4.</span> <span class="post-toc-text">ä»£ç å®ç°</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä¸€ç»´ä»£ç "><span class="post-toc-number">5.</span> <span class="post-toc-text">ä¸€ç»´ä»£ç </span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å®Œæ•´ä»£ç "><span class="post-toc-number">5.1.</span> <span class="post-toc-text">å®Œæ•´ä»£ç </span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#è¿è¡Œç»“æœ"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">è¿è¡Œç»“æœ</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-densenet"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">DenseNetç¥ç»ç½‘ç»œç»“æ„</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-02-09 13:52:33" datetime="2020-02-09T05:52:33.000Z"  itemprop="datePublished">2020-02-09</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/æ·±åº¦å­¦ä¹ /">æ·±åº¦å­¦ä¹ </a></li></ul>



            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>CVPR 2017æœ€ä½³è®ºæ–‡DenseNetï¼Œè®ºæ–‡ä¸­æå‡ºçš„DenseNetï¼ˆDense Convolutional Networkï¼‰ ã€‚</p>
<a id="more"></a>
<p>ä½œä¸ºCVPR2017å¹´çš„Best Paper, DenseNetè„±ç¦»äº†åŠ æ·±ç½‘ç»œå±‚æ•°(ResNet)å’ŒåŠ å®½ç½‘ç»œç»“æ„(Inception)æ¥æå‡ç½‘ç»œæ€§èƒ½çš„å®šå¼æ€ç»´,ä»ç‰¹å¾çš„è§’åº¦è€ƒè™‘,é€šè¿‡ç‰¹å¾é‡ç”¨å’Œæ—è·¯(Bypass)è®¾ç½®,æ—¢å¤§å¹…åº¦å‡å°‘äº†ç½‘ç»œçš„å‚æ•°é‡,åˆåœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº†gradient vanishingï¼ˆæ¢¯åº¦æ¶ˆå¤±ï¼‰é—®é¢˜çš„äº§ç”Ÿ.ç»“åˆä¿¡æ¯æµå’Œç‰¹å¾å¤ç”¨çš„å‡è®¾,DenseNetå½“ä¹‹æ— æ„§æˆä¸º2017å¹´è®¡ç®—æœºè§†è§‰é¡¶ä¼šçš„å¹´åº¦æœ€ä½³è®ºæ–‡.</p>
<p>éšç€CNNç½‘ç»œå±‚æ•°çš„ä¸æ–­å¢åŠ ,gradient vanishingå’Œmodel degradationï¼ˆæ¨¡å‹é€€åŒ–ï¼‰é—®é¢˜å‡ºç°åœ¨äº†äººä»¬é¢å‰,BatchNormalizationï¼ˆæ‰¹è§„èŒƒåŒ–ï¼‰çš„å¹¿æ³›ä½¿ç”¨åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº†gradient vanishingçš„é—®é¢˜,è€ŒResNetå’ŒHighway Networksé€šè¿‡æ„é€ æ’ç­‰æ˜ å°„è®¾ç½®æ—è·¯,è¿›ä¸€æ­¥å‡å°‘äº†gradient vanishingå’Œmodel degradationçš„äº§ç”Ÿ.Fractal Netsé€šè¿‡å°†ä¸åŒæ·±åº¦çš„ç½‘ç»œå¹¶è¡ŒåŒ–,åœ¨è·å¾—äº†æ·±åº¦çš„åŒæ—¶ä¿è¯äº†æ¢¯åº¦çš„ä¼ æ’­,éšæœºæ·±åº¦ç½‘ç»œé€šè¿‡å¯¹ç½‘ç»œä¸­ä¸€äº›å±‚è¿›è¡Œå¤±æ´»,æ—¢è¯æ˜äº†ResNetæ·±åº¦çš„å†—ä½™æ€§,åˆç¼“è§£äº†ä¸Šè¿°é—®é¢˜çš„äº§ç”Ÿ. è™½ç„¶è¿™äº›ä¸åŒçš„ç½‘ç»œæ¡†æ¶é€šè¿‡ä¸åŒçš„å®ç°åŠ æ·±çš„ç½‘ç»œå±‚æ•°,ä½†æ˜¯ä»–ä»¬éƒ½åŒ…å«äº†ç›¸åŒçš„æ ¸å¿ƒæ€æƒ³,æ—¢å°†feature mapè¿›è¡Œè·¨ç½‘ç»œå±‚çš„è¿æ¥.</p>
<h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><ul>
<li><strong>å‡è½»äº†vanishing-gradientï¼ˆæ¢¯åº¦æ¶ˆå¤±ï¼‰</strong></li>
<li><strong>åŠ å¼ºäº†featureçš„ä¼ é€’</strong> </li>
<li><strong>æ›´æœ‰æ•ˆåœ°åˆ©ç”¨äº†feature</strong> </li>
<li><strong>ä¸€å®šç¨‹åº¦ä¸Šè¾ƒå°‘äº†å‚æ•°æ•°é‡</strong> </li>
</ul>
<h2 id="è®¾è®¡ç†å¿µ"><a href="#è®¾è®¡ç†å¿µ" class="headerlink" title="è®¾è®¡ç†å¿µ"></a>è®¾è®¡ç†å¿µ</h2><p>ç›¸æ¯”ResNetï¼ŒDenseNetæå‡ºäº†ä¸€ä¸ªæ›´æ¿€è¿›çš„å¯†é›†è¿æ¥æœºåˆ¶ï¼šå³äº’ç›¸è¿æ¥æ‰€æœ‰çš„å±‚ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯æ¯ä¸ªå±‚éƒ½ä¼šæ¥å—å…¶å‰é¢æ‰€æœ‰å±‚ä½œä¸ºå…¶é¢å¤–çš„è¾“å…¥ã€‚å›¾1ä¸ºResNetç½‘ç»œçš„è¿æ¥æœºåˆ¶ï¼Œä½œä¸ºå¯¹æ¯”ï¼Œå›¾2ä¸ºDenseNetçš„å¯†é›†è¿æ¥æœºåˆ¶ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒResNetæ˜¯æ¯ä¸ªå±‚ä¸å‰é¢çš„æŸå±‚ï¼ˆä¸€èˆ¬æ˜¯2~3å±‚ï¼‰çŸ­è·¯è¿æ¥åœ¨ä¸€èµ·ï¼Œè¿æ¥æ–¹å¼æ˜¯é€šè¿‡å…ƒç´ çº§ç›¸åŠ ã€‚è€Œåœ¨DenseNetä¸­ï¼Œæ¯ä¸ªå±‚éƒ½ä¼šä¸å‰é¢æ‰€æœ‰å±‚åœ¨channelç»´åº¦ä¸Šè¿æ¥ï¼ˆconcatï¼‰åœ¨ä¸€èµ·ï¼ˆè¿™é‡Œå„ä¸ªå±‚çš„ç‰¹å¾å›¾å¤§å°æ˜¯ç›¸åŒçš„ï¼Œåé¢ä¼šæœ‰è¯´æ˜ï¼‰ï¼Œå¹¶ä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚å¯¹äºä¸€ä¸ª Lå±‚çš„ç½‘ç»œï¼ŒDenseNetå…±åŒ…å«(L(L+1))/2ä¸ªè¿æ¥ï¼Œç›¸æ¯”ResNetï¼Œè¿™æ˜¯ä¸€ç§å¯†é›†è¿æ¥ã€‚è€Œä¸”DenseNetæ˜¯ç›´æ¥concatæ¥è‡ªä¸åŒå±‚çš„ç‰¹å¾å›¾ï¼Œè¿™å¯ä»¥å®ç°ç‰¹å¾é‡ç”¨ï¼Œæå‡æ•ˆç‡ï¼Œè¿™ä¸€ç‰¹ç‚¹æ˜¯DenseNetä¸ResNetæœ€ä¸»è¦çš„åŒºåˆ«ã€‚ </p>
<p><img src="https://s2.ax1x.com/2020/02/09/1foPQe.png" alt="å›¾1 ResNetç½‘ç»œçš„çŸ­è·¯è¿æ¥æœºåˆ¶ï¼ˆå…¶ä¸­+ä»£è¡¨çš„æ˜¯å…ƒç´ çº§ç›¸åŠ æ“ä½œï¼‰"></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://s2.ax1x.com/2020/02/09/1foX6g.png" alt="å›¾1 ResNetç½‘ç»œçš„çŸ­è·¯è¿æ¥æœºåˆ¶ï¼ˆå…¶ä¸­+ä»£è¡¨çš„æ˜¯å…ƒç´ çº§ç›¸åŠ æ“ä½œï¼‰" title>
                </div>
                <div class="image-caption">å›¾1 ResNetç½‘ç»œçš„çŸ­è·¯è¿æ¥æœºåˆ¶ï¼ˆå…¶ä¸­+ä»£è¡¨çš„æ˜¯å…ƒç´ çº§ç›¸åŠ æ“ä½œï¼‰</div>
            </figure>
<p> å¦‚æœç”¨å…¬å¼è¡¨ç¤ºçš„è¯ï¼Œä¼ ç»Ÿçš„ç½‘ç»œåœ¨ L å±‚çš„è¾“å‡ºä¸ºï¼š<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://www.zhihu.com/equation?tex=%5C%5Cx_l+%3D+H_l%28x_%7Bl-1%7D%29" alt title>
                </div>
                <div class="image-caption"></div>
            </figure> </p>
<p>è€Œå¯¹äºResNetï¼Œå¢åŠ äº†æ¥è‡ªä¸Šä¸€å±‚è¾“å…¥çš„identityå‡½æ•°ï¼š<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://www.zhihu.com/equation?tex=%5C%5Cx_l+%3D+H_l%28x_%7Bl-1%7D%29+%2B+x_%7Bl-1%7D" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>åœ¨DenseNetä¸­ï¼Œä¼šè¿æ¥å‰é¢æ‰€æœ‰å±‚ä½œä¸ºè¾“å…¥ï¼š<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://www.zhihu.com/equation?tex=%5C%5Cx_l+%3D+H_l%28%5Bx_0%2C+x_1%2C+...%2C+x_%7Bl-1%7D%5D%29" alt title>
                </div>
                <div class="image-caption"></div>
            </figure></p>
<p>å…¶ä¸­ï¼Œä¸Šé¢çš„ <strong>H~L~(.)</strong>ä»£è¡¨æ˜¯éçº¿æ€§è½¬åŒ–å‡½æ•°ï¼ˆnon-liear transformationï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªç»„åˆæ“ä½œï¼Œå…¶å¯èƒ½åŒ…æ‹¬ä¸€ç³»åˆ—çš„BN(Batch Normalization)ï¼ŒReLUï¼ŒPoolingåŠConvæ“ä½œã€‚æ³¨æ„è¿™é‡Œ <strong>L</strong>å±‚ä¸<strong>L-1</strong> å±‚ä¹‹é—´å¯èƒ½å®é™…ä¸ŠåŒ…å«å¤šä¸ªå·ç§¯å±‚ã€‚</p>
<p>DenseNetçš„å‰å‘è¿‡ç¨‹å¦‚å›¾3æ‰€ç¤ºï¼Œå¯ä»¥æ›´ç›´è§‚åœ°ç†è§£å…¶å¯†é›†è¿æ¥æ–¹å¼ï¼Œæ¯”å¦‚ <strong>h~3~</strong> çš„è¾“å…¥ä¸ä»…åŒ…æ‹¬æ¥è‡ª<strong>h~2~</strong> çš„<strong>x~2~</strong>ï¼Œè¿˜åŒ…æ‹¬å‰é¢ä¸¤å±‚çš„ <strong>x~1~</strong>å’Œ <strong>x~2~</strong> ï¼Œå®ƒä»¬æ˜¯åœ¨channelç»´åº¦ä¸Šè¿æ¥åœ¨ä¸€èµ·çš„ã€‚</p>
<h2 id="ç½‘ç»œç»“æ„"><a href="#ç½‘ç»œç»“æ„" class="headerlink" title="ç½‘ç»œç»“æ„"></a>ç½‘ç»œç»“æ„</h2><p> å¦‚å›¾æ‰€ç¤ºï¼ŒDenseNetçš„ç½‘ç»œç»“æ„ä¸»è¦ç”±DenseBlockå’ŒTransitionç»„æˆã€‚ <figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://pic4.zhimg.com/80/v2-0b28a49f274da9bd8dec2dccddf1ec53_hd.jpg" alt title>
                </div>
                <div class="image-caption"></div>
            </figure> </p>
<p>åœ¨DenseBlockä¸­ï¼Œå„ä¸ªå±‚çš„ç‰¹å¾å›¾å¤§å°ä¸€è‡´ï¼Œå¯ä»¥åœ¨channelç»´åº¦ä¸Šè¿æ¥ã€‚DenseBlockä¸­çš„éçº¿æ€§ç»„åˆå‡½æ•° <strong>H(.)</strong> é‡‡ç”¨çš„æ˜¯<strong>BN+ReLU+3x3 Conv</strong>çš„ç»“æ„ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚å¦å¤–å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œä¸ResNetä¸åŒï¼Œæ‰€æœ‰DenseBlockä¸­å„ä¸ªå±‚å·ç§¯ä¹‹åå‡è¾“å‡º<strong>K</strong>ä¸ªç‰¹å¾å›¾ï¼Œå³å¾—åˆ°çš„ç‰¹å¾å›¾çš„channelæ•°ä¸º<strong>K</strong>ï¼Œæˆ–è€…è¯´é‡‡ç”¨<strong>K</strong>ä¸ªå·ç§¯æ ¸ï¼Œ<strong>K</strong>åœ¨DenseNetç§°ä¸ºgrowth rateï¼Œè¿™æ˜¯ä¸€ä¸ªè¶…å‚æ•°ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨è¾ƒå°çš„<strong>K</strong>ï¼ˆæ¯”å¦‚12ï¼‰ï¼Œå°±å¯ä»¥å¾—åˆ°è¾ƒä½³çš„æ€§èƒ½ã€‚å‡å®šè¾“å…¥å±‚çš„ç‰¹å¾å›¾çš„channelæ•°ä¸º<strong>K~0~</strong>ï¼Œé‚£ä¹ˆ<strong>L</strong>å±‚è¾“å…¥çš„channelæ•°ä¸º<strong>k~0~+k(L-1)</strong>ï¼Œå› æ­¤éšç€å±‚æ•°å¢åŠ ï¼Œå°½ç®¡<strong>K</strong>è®¾å®šå¾—è¾ƒå°ï¼ŒDenseBlockçš„è¾“å…¥ä¼šéå¸¸å¤šï¼Œä¸è¿‡è¿™æ˜¯ç”±äºç‰¹å¾é‡ç”¨æ‰€é€ æˆçš„ï¼Œæ¯ä¸ªå±‚ä»…æœ‰<strong>K</strong>ä¸ªç‰¹å¾æ˜¯è‡ªå·±ç‹¬æœ‰çš„ã€‚</p>
<p> <img src="https://pic4.zhimg.com/80/v2-7114e1583347944ea287b9552202b0ab_hd.jpg" alt> </p>
<p>ç”±äºåé¢å±‚çš„è¾“å…¥ä¼šéå¸¸å¤§ï¼ŒDenseBlockå†…éƒ¨å¯ä»¥é‡‡ç”¨bottleneckå±‚æ¥å‡å°‘è®¡ç®—é‡ï¼Œä¸»è¦æ˜¯åŸæœ‰çš„ç»“æ„ä¸­å¢åŠ 1x1 Convï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œå³<strong>BN+ReLU+1x1 Conv+BN+ReLU+3x3 Conv</strong>ï¼Œç§°ä¸ºDenseNet-Bç»“æ„ã€‚å…¶ä¸­1x1 Convå¾—åˆ°<strong>4K</strong>ä¸ªç‰¹å¾å›¾å®ƒèµ·åˆ°çš„ä½œç”¨æ˜¯é™ä½ç‰¹å¾æ•°é‡ï¼Œä»è€Œæå‡è®¡ç®—æ•ˆç‡ã€‚ </p>
<p><img src="https://pic1.zhimg.com/v2-4de2c07f516b030b864181c79734dc8c_r.jpg" alt="preview"> </p>
<p>å¯¹äºTransitionå±‚ï¼Œå®ƒä¸»è¦æ˜¯è¿æ¥ä¸¤ä¸ªç›¸é‚»çš„DenseBlockï¼Œå¹¶ä¸”é™ä½ç‰¹å¾å›¾å¤§å°ã€‚Transitionå±‚åŒ…æ‹¬ä¸€ä¸ª1x1çš„å·ç§¯å’Œ2x2çš„AvgPoolingï¼Œç»“æ„ä¸º<strong>BN+ReLU+1x1 Conv+2x2 AvgPooling</strong>ã€‚å¦å¤–ï¼ŒTransitionå±‚å¯ä»¥èµ·åˆ°å‹ç¼©æ¨¡å‹çš„ä½œç”¨ã€‚å‡å®šTransitionçš„ä¸Šæ¥DenseBlockå¾—åˆ°çš„ç‰¹å¾å›¾channelsæ•°ä¸º<strong>m</strong>ï¼ŒTransitionå±‚å¯ä»¥äº§ç”Ÿ<strong>[Î¸m]</strong>ä¸ªç‰¹å¾ï¼ˆé€šè¿‡å·ç§¯å±‚ï¼‰ï¼Œå…¶ä¸­<strong>Î¸âˆˆï¼ˆ0ï¼Œ1]</strong>æ˜¯å‹ç¼©ç³»æ•°ï¼ˆcompression rateï¼‰ã€‚å½“<strong>Î¸=1</strong>æ—¶ï¼Œç‰¹å¾ä¸ªæ•°ç»è¿‡Transitionå±‚æ²¡æœ‰å˜åŒ–ï¼Œå³æ— å‹ç¼©ï¼Œè€Œå½“å‹ç¼©ç³»æ•°å°äº1æ—¶ï¼Œè¿™ç§ç»“æ„ç§°ä¸ºDenseNet-Cï¼Œå¯¹äºä½¿ç”¨bottleneckå±‚çš„DenseBlockç»“æ„å’Œå‹ç¼©ç³»æ•°å°äº1çš„Transitionç»„åˆç»“æ„ç§°ä¸ºDenseNet-BCã€‚</p>
<p>DenseNetå…±åœ¨ä¸‰ä¸ªå›¾åƒåˆ†ç±»æ•°æ®é›†ï¼ˆCIFARï¼ŒSVHNå’ŒImageNetï¼‰ä¸Šè¿›è¡Œæµ‹è¯•ã€‚å¯¹äºå‰ä¸¤ä¸ªæ•°æ®é›†ï¼Œå…¶è¾“å…¥å›¾ç‰‡å¤§å°ä¸º<strong>32Ã—32</strong>ï¼Œæ‰€ä½¿ç”¨çš„DenseNetåœ¨è¿›å…¥ç¬¬ä¸€ä¸ªDenseBlockä¹‹å‰ï¼Œé¦–å…ˆè¿›è¡Œè¿›è¡Œä¸€æ¬¡3x3å·ç§¯ï¼ˆstride=1ï¼‰ï¼Œå·ç§¯æ ¸æ•°ä¸º16ï¼ˆå¯¹äºDenseNet-BCä¸º<strong>2K</strong>ï¼‰ã€‚DenseNetå…±åŒ…å«ä¸‰ä¸ªDenseBlockï¼Œå„ä¸ªæ¨¡å—çš„ç‰¹å¾å›¾å¤§å°åˆ†åˆ«ä¸º<strong>32Ã—32</strong>ï¼Œ<strong>16Ã—16</strong>å’Œ<strong>8Ã—8</strong>ï¼Œæ¯ä¸ªDenseBlocké‡Œé¢çš„å±‚æ•°ç›¸åŒã€‚æœ€åçš„DenseBlockä¹‹åæ˜¯ä¸€ä¸ªglobal AvgPoolingå±‚ï¼Œç„¶åé€å…¥ä¸€ä¸ªsoftmaxåˆ†ç±»å™¨ã€‚æ³¨æ„ï¼Œåœ¨DenseNetä¸­ï¼Œæ‰€æœ‰çš„3x3å·ç§¯å‡é‡‡ç”¨padding=1çš„æ–¹å¼ä»¥ä¿è¯ç‰¹å¾å›¾å¤§å°ç»´æŒä¸å˜ã€‚å¯¹äºåŸºæœ¬çš„DenseNetï¼Œä½¿ç”¨å¦‚ä¸‹ä¸‰ç§ç½‘ç»œé…ç½®ï¼š<strong>{L=40ï¼Œk=12},{L=100,k=12},{L=40,k=24}</strong>ã€‚è€Œå¯¹äºDenseNet-BCç»“æ„ï¼Œä½¿ç”¨å¦‚ä¸‹ä¸‰ç§ç½‘ç»œé…ç½®ï¼š<strong>{L=100ï¼Œk=12},{L=250,k=24},{L=250,k=40}</strong> ã€‚è¿™é‡Œçš„<strong>L</strong>æŒ‡çš„æ˜¯ç½‘ç»œæ€»å±‚æ•°ï¼ˆç½‘ç»œæ·±åº¦ï¼‰ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæŠŠå¸¦æœ‰è®­ç»ƒå‚æ•°çš„å±‚ç®—å…¥å…¶ä¸­ï¼Œè€ŒåƒPoolingè¿™æ ·çš„æ— å‚æ•°å±‚ä¸çº³å…¥ç»Ÿè®¡ä¸­ï¼Œæ­¤å¤–BNå±‚å°½ç®¡åŒ…å«å‚æ•°ä½†æ˜¯ä¹Ÿä¸å•ç‹¬ç»Ÿè®¡ï¼Œè€Œæ˜¯å¯ä»¥è®¡å…¥å®ƒæ‰€é™„å±çš„å·ç§¯å±‚ã€‚å¯¹äºæ™®é€šçš„<strong>L=40,k=12</strong>ç½‘ç»œï¼Œé™¤å»ç¬¬ä¸€ä¸ªå·ç§¯å±‚ã€2ä¸ªTransitionä¸­å·ç§¯å±‚ä»¥åŠæœ€åçš„Linearå±‚ï¼Œå…±å‰©ä½™36å±‚ï¼Œå‡åˆ†åˆ°ä¸‰ä¸ªDenseBlockå¯çŸ¥æ¯ä¸ªDenseBlockåŒ…å«12å±‚ã€‚å…¶å®ƒçš„ç½‘ç»œé…ç½®åŒæ ·å¯ä»¥ç®—å‡ºå„ä¸ªDenseBlockæ‰€å«å±‚æ•°ã€‚</p>
<p>å¯¹äºImageNetæ•°æ®é›†ï¼Œå›¾ç‰‡è¾“å…¥å¤§å°ä¸º<strong>224Ã—224</strong>ï¼Œç½‘ç»œç»“æ„é‡‡ç”¨åŒ…å«4ä¸ªDenseBlockçš„DenseNet-BCï¼Œå…¶é¦–å…ˆæ˜¯ä¸€ä¸ªstride=2çš„7x7å·ç§¯å±‚ï¼ˆå·ç§¯æ ¸æ•°ä¸º<strong>2K</strong>ï¼‰ï¼Œç„¶åæ˜¯ä¸€ä¸ª<strong>stride</strong>=2çš„3x3 MaxPoolingå±‚ï¼Œåé¢æ‰è¿›å…¥DenseBlockã€‚ImageNetæ•°æ®é›†æ‰€é‡‡ç”¨çš„ç½‘ç»œé…ç½®å¦‚è¡¨æ‰€ç¤ºï¼š</p>
<p> <img src="https://pic1.zhimg.com/80/v2-c712b7a04200ecfd05c79478adb18888_hd.jpg" alt="img"> </p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><pre><code class="lang-python">import tensorflow as tf
from tflearn.layers.conv import global_avg_pool
from tensorflow.contrib.layers import batch_norm, flatten
from tensorflow.contrib.layers import xavier_initializer
from tensorflow.contrib.framework import arg_scope
from cifar10 import *

# Hyperparameter
growth_k = 24
nb_block = 2 # how many (dense block + Transition Layer) ?
init_learning_rate = 1e-4
epsilon = 1e-4 # AdamOptimizer epsilon
dropout_rate = 0.2

# Momentum Optimizer will use
nesterov_momentum = 0.9
weight_decay = 1e-4

# Label &amp; batch_size
batch_size = 64

iteration = 782
# batch_size * iteration = data_set_number

test_iteration = 10

total_epochs = 300

def conv_layer(input, filter, kernel, stride=1, layer_name=&quot;conv&quot;):
    with tf.name_scope(layer_name):
        network = tf.layers.conv2d(inputs=input, use_bias=False, filters=filter, kernel_size=kernel, strides=stride, padding=&#39;SAME&#39;)
        return network

def Global_Average_Pooling(x, stride=1):
    &quot;&quot;&quot;
    width = np.shape(x)[1]
    height = np.shape(x)[2]
    pool_size = [width, height]
    return tf.layers.average_pooling2d(inputs=x, pool_size=pool_size, strides=stride) # The stride value does not matter
    It is global average pooling without tflearn
    &quot;&quot;&quot;

    return global_avg_pool(x, name=&#39;Global_avg_pooling&#39;)
    # But maybe you need to install h5py and curses or not


def Batch_Normalization(x, training, scope):
    with arg_scope([batch_norm],
                   scope=scope,
                   updates_collections=None,
                   decay=0.9,
                   center=True,
                   scale=True,
                   zero_debias_moving_mean=True) :
        return tf.cond(training,
                       lambda : batch_norm(inputs=x, is_training=training, reuse=None),
                       lambda : batch_norm(inputs=x, is_training=training, reuse=True))

def Drop_out(x, rate, training) :
    return tf.layers.dropout(inputs=x, rate=rate, training=training)

def Relu(x):
    return tf.nn.relu(x)

def Average_pooling(x, pool_size=[2,2], stride=2, padding=&#39;VALID&#39;):
    return tf.layers.average_pooling2d(inputs=x, pool_size=pool_size, strides=stride, padding=padding)


def Max_Pooling(x, pool_size=[3,3], stride=2, padding=&#39;VALID&#39;):
    return tf.layers.max_pooling2d(inputs=x, pool_size=pool_size, strides=stride, padding=padding)

def Concatenation(layers) :
    return tf.concat(layers, axis=3)

def Linear(x) :
    return tf.layers.dense(inputs=x, units=class_num, name=&#39;linear&#39;)

def Evaluate(sess):
    test_acc = 0.0
    test_loss = 0.0
    test_pre_index = 0
    add = 1000

    for it in range(test_iteration):
        test_batch_x = test_x[test_pre_index: test_pre_index + add]
        test_batch_y = test_y[test_pre_index: test_pre_index + add]
        test_pre_index = test_pre_index + add

        test_feed_dict = {
            x: test_batch_x,
            label: test_batch_y,
            learning_rate: epoch_learning_rate,
            training_flag: False
        }

        loss_, acc_ = sess.run([cost, accuracy], feed_dict=test_feed_dict)

        test_loss += loss_ / 10.0
        test_acc += acc_ / 10.0

    summary = tf.Summary(value=[tf.Summary.Value(tag=&#39;test_loss&#39;, simple_value=test_loss),
                                tf.Summary.Value(tag=&#39;test_accuracy&#39;, simple_value=test_acc)])

    return test_acc, test_loss, summary

class DenseNet():
    def __init__(self, x, nb_blocks, filters, training):
        self.nb_blocks = nb_blocks
        self.filters = filters
        self.training = training
        self.model = self.Dense_net(x)


    def bottleneck_layer(self, x, scope):
        # print(x)
        with tf.name_scope(scope):
            x = Batch_Normalization(x, training=self.training, scope=scope+&#39;_batch1&#39;)
            x = Relu(x)
            x = conv_layer(x, filter=4 * self.filters, kernel=[1,1], layer_name=scope+&#39;_conv1&#39;)
            x = Drop_out(x, rate=dropout_rate, training=self.training)

            x = Batch_Normalization(x, training=self.training, scope=scope+&#39;_batch2&#39;)
            x = Relu(x)
            x = conv_layer(x, filter=self.filters, kernel=[3,3], layer_name=scope+&#39;_conv2&#39;)
            x = Drop_out(x, rate=dropout_rate, training=self.training)

            # print(x)

            return x

    def transition_layer(self, x, scope):
        with tf.name_scope(scope):
            x = Batch_Normalization(x, training=self.training, scope=scope+&#39;_batch1&#39;)
            x = Relu(x)
            # x = conv_layer(x, filter=self.filters, kernel=[1,1], layer_name=scope+&#39;_conv1&#39;)

            # https://github.com/taki0112/Densenet-Tensorflow/issues/10

            in_channel = x.shape[-1]
            x = conv_layer(x, filter=in_channel*0.5, kernel=[1,1], layer_name=scope+&#39;_conv1&#39;)
            x = Drop_out(x, rate=dropout_rate, training=self.training)
            x = Average_pooling(x, pool_size=[2,2], stride=2)

            return x

    def dense_block(self, input_x, nb_layers, layer_name):
        with tf.name_scope(layer_name):
            layers_concat = list()
            layers_concat.append(input_x)

            x = self.bottleneck_layer(input_x, scope=layer_name + &#39;_bottleN_&#39; + str(0))

            layers_concat.append(x)

            for i in range(nb_layers - 1):
                x = Concatenation(layers_concat)
                x = self.bottleneck_layer(x, scope=layer_name + &#39;_bottleN_&#39; + str(i + 1))
                layers_concat.append(x)

            x = Concatenation(layers_concat)

            return x

    def Dense_net(self, input_x):
        x = conv_layer(input_x, filter=2 * self.filters, kernel=[7,7], stride=2, layer_name=&#39;conv0&#39;)
        # x = Max_Pooling(x, pool_size=[3,3], stride=2)


        &quot;&quot;&quot;
        for i in range(self.nb_blocks) :
            # 6 -&gt; 12 -&gt; 48
            x = self.dense_block(input_x=x, nb_layers=4, layer_name=&#39;dense_&#39;+str(i))
            x = self.transition_layer(x, scope=&#39;trans_&#39;+str(i))
        &quot;&quot;&quot;




        x = self.dense_block(input_x=x, nb_layers=6, layer_name=&#39;dense_1&#39;)
        x = self.transition_layer(x, scope=&#39;trans_1&#39;)

        x = self.dense_block(input_x=x, nb_layers=12, layer_name=&#39;dense_2&#39;)
        x = self.transition_layer(x, scope=&#39;trans_2&#39;)

        x = self.dense_block(input_x=x, nb_layers=48, layer_name=&#39;dense_3&#39;)
        x = self.transition_layer(x, scope=&#39;trans_3&#39;)

        x = self.dense_block(input_x=x, nb_layers=32, layer_name=&#39;dense_final&#39;)



        # 100 Layer
        x = Batch_Normalization(x, training=self.training, scope=&#39;linear_batch&#39;)
        x = Relu(x)
        x = Global_Average_Pooling(x)
        x = flatten(x)
        x = Linear(x)


        # x = tf.reshape(x, [-1, 10])
        return x



train_x, train_y, test_x, test_y = prepare_data()
train_x, test_x = color_preprocessing(train_x, test_x)

# image_size = 32, img_channels = 3, class_num = 10 in cifar10
x = tf.placeholder(tf.float32, shape=[None, image_size, image_size, img_channels])
label = tf.placeholder(tf.float32, shape=[None, class_num])

training_flag = tf.placeholder(tf.bool)


learning_rate = tf.placeholder(tf.float32, name=&#39;learning_rate&#39;)

logits = DenseNet(x=x, nb_blocks=nb_block, filters=growth_k, training=training_flag).model
cost = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=label, logits=logits))

&quot;&quot;&quot;
l2_loss = tf.add_n([tf.nn.l2_loss(var) for var in tf.trainable_variables()])
optimizer = tf.train.MomentumOptimizer(learning_rate=learning_rate, momentum=nesterov_momentum, use_nesterov=True)
train = optimizer.minimize(cost + l2_loss * weight_decay)
In paper, use MomentumOptimizer
init_learning_rate = 0.1
but, I&#39;ll use AdamOptimizer
&quot;&quot;&quot;

optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate, epsilon=epsilon)
train = optimizer.minimize(cost)


correct_prediction = tf.equal(tf.argmax(logits, 1), tf.argmax(label, 1))
accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))

saver = tf.train.Saver(tf.global_variables())

with tf.Session() as sess:
    ckpt = tf.train.get_checkpoint_state(&#39;./model&#39;)
    if ckpt and tf.train.checkpoint_exists(ckpt.model_checkpoint_path):
        saver.restore(sess, ckpt.model_checkpoint_path)
    else:
        sess.run(tf.global_variables_initializer())

    summary_writer = tf.summary.FileWriter(&#39;./logs&#39;, sess.graph)

    epoch_learning_rate = init_learning_rate
    for epoch in range(1, total_epochs + 1):
        if epoch == (total_epochs * 0.5) or epoch == (total_epochs * 0.75):
            epoch_learning_rate = epoch_learning_rate / 10

        pre_index = 0
        train_acc = 0.0
        train_loss = 0.0


        for step in range(1, iteration + 1):
            if pre_index+batch_size &lt; 50000 :
                batch_x = train_x[pre_index : pre_index+batch_size]
                batch_y = train_y[pre_index : pre_index+batch_size]
            else :
                batch_x = train_x[pre_index : ]
                batch_y = train_y[pre_index : ]

            batch_x = data_augmentation(batch_x)

            train_feed_dict = {
                x: batch_x,
                label: batch_y,
                learning_rate: epoch_learning_rate,
                training_flag : True
            }

            _, batch_loss = sess.run([train, cost], feed_dict=train_feed_dict)
            batch_acc = accuracy.eval(feed_dict=train_feed_dict)

            train_loss += batch_loss
            train_acc += batch_acc
            pre_index += batch_size

            if step == iteration :
                train_loss /= iteration # average loss
                train_acc /= iteration # average accuracy

                train_summary = tf.Summary(value=[tf.Summary.Value(tag=&#39;train_loss&#39;, simple_value=train_loss),
                                                  tf.Summary.Value(tag=&#39;train_accuracy&#39;, simple_value=train_acc)])

                test_acc, test_loss, test_summary = Evaluate(sess)

                summary_writer.add_summary(summary=train_summary, global_step=epoch)
                summary_writer.add_summary(summary=test_summary, global_step=epoch)
                summary_writer.flush()

                line = &quot;epoch: %d/%d, train_loss: %.4f, train_acc: %.4f, test_loss: %.4f, test_acc: %.4f \n&quot; % (
                    epoch, total_epochs, train_loss, train_acc, test_loss, test_acc)
                print(line)

                with open(&#39;logs.txt&#39;, &#39;a&#39;) as f :
                    f.write(line)



        saver.save(sess=sess, save_path=&#39;./model/dense.ckpt&#39;)
</code></pre>
<h2 id="ä¸€ç»´ä»£ç "><a href="#ä¸€ç»´ä»£ç " class="headerlink" title="ä¸€ç»´ä»£ç "></a>ä¸€ç»´ä»£ç </h2><p>ç”±äºæˆ‘åšçš„æ˜¯ä¸€ç»´æ•°æ®è¯†åˆ«ï¼Œéœ€è¦å°†ä»£ç æ”¹ä¸ºä¸€ç»´ï¼Œå’Œä¿®æ”¹æ•°æ®è¯»å…¥ã€‚</p>
<p>ä¿®æ”¹ä¸‹é¢éƒ¨åˆ†å³å¯æ”¹å˜ç½‘ç»œç»“æ„ï¼Œç”±äºç”µè„‘æ˜¾å¡å¤ªå·®ï¼ŒåŸè®ºæ–‡ä¸­çš„ç»“æ„ä¼šå› ä¸ºæ˜¾å­˜ä¸å¤Ÿè€ŒæŠ¥é”™ã€‚</p>
<pre><code class="lang-python">def Dense_net(self, input_x):
        x = conv_layer(input_x, filter=2 * self.filters, kernel=[1, 7], stride=2, layer_name=&#39;conv0&#39;)#å·ç§¯
        x = Max_Pooling(x, pool_size=[1, 3], stride=2)#æœ€å¤§æ± åŒ–

        for i in range(self.nb_blocks):
            # 6 -&gt; 12 -&gt; 48
            x = self.dense_block(input_x=x, nb_layers=2, layer_name=&#39;dense_&#39; + str(i))
            x = self.transition_layer(x, scope=&#39;trans_&#39; + str(i))

        &quot;&quot;&quot;
        x = self.dense_block(input_x=x, nb_layers=6, layer_name=&#39;dense_1&#39;)
        x = self.transition_layer(x, scope=&#39;trans_1&#39;)

        x = self.dense_block(input_x=x, nb_layers=12, layer_name=&#39;dense_2&#39;)
        x = self.transition_layer(x, scope=&#39;trans_2&#39;)

        x = self.dense_block(input_x=x, nb_layers=48, layer_name=&#39;dense_3&#39;)
        x = self.transition_layer(x, scope=&#39;trans_3&#39;)
        &quot;&quot;&quot;  

        x = self.dense_block(input_x=x, nb_layers=4, layer_name=&#39;dense_final&#39;)

        # 100 Layer
        x = Batch_Normalization(x, training=self.training, scope=&#39;linear_batch&#39;)
        x = Relu(x)
        x = Global_Average_Pooling(x)
        x = flatten(x)
        x = Linear(x)

        # x = tf.reshape(x, [-1, 10])
        return x
</code></pre>
<h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h3><pre><code class="lang-python">import tensorflow as tf
from tflearn.layers.conv import global_avg_pool
from tensorflow.examples.tutorials.mnist import input_data
from tensorflow.contrib.layers import batch_norm, flatten
from tensorflow.contrib.framework import arg_scope
import numpy as np
import matplotlib.pyplot as plt


# Hyperparameter
growth_k = 12
nb_block = 1  # how many (dense block + Transition Layer) ?
init_learning_rate = 1e-3
epsilon = 1e-8  # AdamOptimizer epsilon
dropout_rate = 0.2

# Momentum Optimizer will use
nesterov_momentum = 0.9
weight_decay = 1e-4

# Label &amp; batch_size
class_num = 2


total_epochs = 400


DATA_SIZE = 1175
BATCH_SIZE =128

acc_print=[]
acc_printx=[]
acc_printy=[]

tf.reset_default_graph()
def conv_layer(input, filter, kernel, stride=1, layer_name=&quot;conv&quot;):
    with tf.name_scope(layer_name):
        network = tf.layers.conv2d(inputs=input, filters=filter, kernel_size=kernel, strides=stride, padding=&#39;SAME&#39;)
        return network


def Global_Average_Pooling(x, stride=1):
    &quot;&quot;&quot;
    width = np.shape(x)[1]
    height = np.shape(x)[2]
    pool_size = [width, height]
    return tf.layers.average_pooling2d(inputs=x, pool_size=pool_size, strides=stride) # The stride value does not matter
    It is global average pooling without tflearn
    &quot;&quot;&quot;

    return global_avg_pool(x, name=&#39;Global_avg_pooling&#39;)
    # But maybe you need to install h5py and curses or not


def Batch_Normalization(x, training, scope):
    with arg_scope([batch_norm],
                   scope=scope,
                   updates_collections=None,
                   decay=0.9,
                   center=True,
                   scale=True,
                   zero_debias_moving_mean=True):
        return tf.cond(training,
                       lambda: batch_norm(inputs=x, is_training=training, reuse=None),
                       lambda: batch_norm(inputs=x, is_training=training, reuse=True))


def Drop_out(x, rate, training):
    return tf.layers.dropout(inputs=x, rate=rate, training=training)


def Relu(x):
    return tf.nn.relu(x)


def Average_pooling(x, pool_size=[1, 2], stride=2, padding=&#39;VALID&#39;):
    return tf.layers.average_pooling2d(inputs=x, pool_size=pool_size, strides=stride, padding=padding)


def Max_Pooling(x, pool_size=[1, 3], stride=2, padding=&#39;VALID&#39;):
    return tf.layers.max_pooling2d(inputs=x, pool_size=pool_size, strides=stride, padding=padding)


def Concatenation(layers):
    return tf.concat(layers, axis=3)


def Linear(x):
    return tf.layers.dense(inputs=x, units=class_num, name=&#39;linear&#39;)


class DenseNet():
    def __init__(self, x, nb_blocks, filters, training):
        self.nb_blocks = nb_blocks
        self.filters = filters
        self.training = training
        self.model = self.Dense_net(x)

    def bottleneck_layer(self, x, scope):
        # print(x)
        with tf.name_scope(scope):
            x = Batch_Normalization(x, training=self.training, scope=scope + &#39;_batch1&#39;)
            x = Relu(x)
            x = conv_layer(x, filter=4 * self.filters, kernel=[1, 1], layer_name=scope + &#39;_conv1&#39;)
            x = Drop_out(x, rate=dropout_rate, training=self.training)

            x = Batch_Normalization(x, training=self.training, scope=scope + &#39;_batch2&#39;)
            x = Relu(x)
            x = conv_layer(x, filter=self.filters, kernel=[1, 3], layer_name=scope + &#39;_conv2&#39;)
            x = Drop_out(x, rate=dropout_rate, training=self.training)

            # print(x)

            return x

    def transition_layer(self, x, scope):
        with tf.name_scope(scope):
            x = Batch_Normalization(x, training=self.training, scope=scope + &#39;_batch1&#39;)
            x = Relu(x)
            x = conv_layer(x, filter=self.filters, kernel=[1,1], layer_name=scope+&#39;_conv1&#39;)

            # https://github.com/taki0112/Densenet-Tensorflow/issues/10

            #in_channel = x.shape[-1]
            #x = conv_layer(x, filter=in_channel * 1, kernel=[1, 1], layer_name=scope + &#39;_conv1&#39;)
            x = Drop_out(x, rate=dropout_rate, training=self.training)
            x = Average_pooling(x, pool_size=[1, 2], stride=2)

            return x

    def dense_block(self, input_x, nb_layers, layer_name):
        with tf.name_scope(layer_name):
            layers_concat = list()
            layers_concat.append(input_x)

            x = self.bottleneck_layer(input_x, scope=layer_name + &#39;_bottleN_&#39; + str(0))

            layers_concat.append(x)

            for i in range(nb_layers - 1):
                x = Concatenation(layers_concat)
                x = self.bottleneck_layer(x, scope=layer_name + &#39;_bottleN_&#39; + str(i + 1))
                layers_concat.append(x)

            x = Concatenation(layers_concat)

            return x

    def Dense_net(self, input_x):
        x = conv_layer(input_x, filter=2 * self.filters, kernel=[1, 7], stride=2, layer_name=&#39;conv0&#39;)#å·ç§¯
        x = Max_Pooling(x, pool_size=[1, 3], stride=2)#æœ€å¤§æ± åŒ–

        for i in range(self.nb_blocks):
            # 6 -&gt; 12 -&gt; 48
            x = self.dense_block(input_x=x, nb_layers=2, layer_name=&#39;dense_&#39; + str(i))
            x = self.transition_layer(x, scope=&#39;trans_&#39; + str(i))

        &quot;&quot;&quot;
        x = self.dense_block(input_x=x, nb_layers=6, layer_name=&#39;dense_1&#39;)
        x = self.transition_layer(x, scope=&#39;trans_1&#39;)

        x = self.dense_block(input_x=x, nb_layers=12, layer_name=&#39;dense_2&#39;)
        x = self.transition_layer(x, scope=&#39;trans_2&#39;)

        x = self.dense_block(input_x=x, nb_layers=48, layer_name=&#39;dense_3&#39;)
        x = self.transition_layer(x, scope=&#39;trans_3&#39;)
        &quot;&quot;&quot;  

        x = self.dense_block(input_x=x, nb_layers=4, layer_name=&#39;dense_final&#39;)

        # 100 Layer
        x = Batch_Normalization(x, training=self.training, scope=&#39;linear_batch&#39;)
        x = Relu(x)
        x = Global_Average_Pooling(x)
        x = flatten(x)
        x = Linear(x)

        # x = tf.reshape(x, [-1, 10])
        return x


def convert_to_one_hot(Y, C):       #è½¬ä¸º1ä½çƒ­ç ç¼–ç 
    Y = np.eye(C)[Y.reshape(-1)].T
    return Y

string0=np.loadtxt(&#39;4.30+5.1.txt&#39;,dtype=np.float32)
trainy=string0[:,0].reshape(-1,1).T  #1è¡Œ
trainx=string0[:,1:].reshape(1175,-1)
trainy= convert_to_one_hot(trainy.astype(int), 2).T



x = tf.placeholder(tf.float32, shape=[None, 500])
batch_images = tf.reshape(x, [-1,1,500,1])

label = tf.placeholder(tf.float32, shape=[None, 2])

training_flag = tf.placeholder(tf.bool)

learning_rate = tf.placeholder(tf.float32, name=&#39;learning_rate&#39;)

logits = DenseNet(x=batch_images, nb_blocks=nb_block, filters=growth_k, training=training_flag).model
cost = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=label, logits=logits))

&quot;&quot;&quot;
l2_loss = tf.add_n([tf.nn.l2_loss(var) for var in tf.trainable_variables()])
optimizer = tf.train.MomentumOptimizer(learning_rate=learning_rate, momentum=nesterov_momentum, use_nesterov=True)
train = optimizer.minimize(cost + l2_loss * weight_decay)
In paper, use MomentumOptimizer
init_learning_rate = 0.1
but, I&#39;ll use AdamOptimizer
&quot;&quot;&quot;

optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate, epsilon=epsilon)
train = optimizer.minimize(cost)

correct_prediction = tf.equal(tf.argmax(logits, 1), tf.argmax(label, 1))
accuracy = tf.reduce_mean(tf.cast(correct_prediction, &quot;float&quot;))

tf.summary.scalar(&#39;loss&#39;, cost)
tf.summary.scalar(&#39;accuracy&#39;, accuracy)

saver = tf.train.Saver(tf.global_variables())

with tf.Session() as sess:
    ckpt = tf.train.get_checkpoint_state(&#39;./model&#39;)
    if ckpt and tf.train.checkpoint_exists(ckpt.model_checkpoint_path):        #å¯»æ‰¾æ¨¡å‹è·¯å¾„
        saver.restore(sess, ckpt.model_checkpoint_path)
    else:
        sess.run(tf.global_variables_initializer())

    merged = tf.summary.merge_all()         #åˆå¹¶é»˜è®¤å›¾ä¸­æ”¶é›†çš„æ‰€æœ‰æ‘˜è¦ã€‚
    writer = tf.summary.FileWriter(&#39;./logs&#39;, sess.graph)    #æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ç”¨æ¥ä¿å­˜å›¾

    global_step = 0
    epoch_learning_rate = init_learning_rate
    i=1
    for epoch in range(total_epochs):
        if epoch == (total_epochs * 0.5) or epoch == (total_epochs * 0.75):
            epoch_learning_rate = epoch_learning_rate / 10

        total_batch =10  #è®­ç»ƒæ€»æ¬¡æ•°

        for step in range(total_batch):
            start = (step * BATCH_SIZE) % DATA_SIZE
            end = min(start + BATCH_SIZE, DATA_SIZE)

            # æ¯æ¬¡é€‰å–batch_sizeä¸ªæ ·æœ¬è¿›è¡Œè®­ç»ƒ
            # _, loss_value, step = sess.run([train_op, loss, global_step], feed_dict={x: trainx[start: end], y_: trainy[start: end]})
            batch_x =trainx[start: end]
            batch_y =trainy[start: end]

            train_feed_dict = {
                    x: batch_x,
                    label: batch_y,
                    learning_rate: epoch_learning_rate,
                    training_flag: True
                    }

            _, loss = sess.run([train, cost], feed_dict=train_feed_dict)

        if epoch % 10 == 0:
            global_step += 100
            train_summary, train_accuracy = sess.run( [merged,accuracy], feed_dict=train_feed_dict)
            #t_accuracy = sess.run(accuracy,feed_dict={x:batch_x,label:batch_y})
            print(&quot;Step:&quot;, epoch, &quot;Loss:&quot;, loss, &quot;Training accuracy:&quot;, train_accuracy)
            writer.add_summary(train_summary, global_step=epoch)
            acc_print.append(train_accuracy)
            acc_printy.append(loss)
            acc_printx.append(i)
            i+=1



        test_feed_dict = {
            x: trainx[start:end],
            label: trainy[start:end],
            learning_rate: epoch_learning_rate,
            training_flag: False
        }

        #accuracy_rates = sess.run(accuracy, feed_dict=test_feed_dict)
        #print(&#39;Epoch:&#39;, &#39;%04d&#39; % (epoch + 1), &#39;/ Accuracy =&#39;, accuracy_rates)
        # writer.add_summary(test_summary, global_step=epoch)
    plt.title(&quot;trend of accuracy&quot;)
    plt.plot(acc_printx,acc_print,color=&#39;r&#39;)
    plt.plot(acc_printx,acc_printy,color=&#39;cyan&#39;)
    plt.show()
    saver.save(sess=sess, save_path=&#39;./model/dense.ckpt&#39;)
</code></pre>
<h3 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h3><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://s2.ax1x.com/2020/02/09/1fbO5n.png" alt="å‡†ç¡®ç‡å’Œlosså€¼" title>
                </div>
                <div class="image-caption">å‡†ç¡®ç‡å’Œlosså€¼</div>
            </figure>
<p>ä¸å¾—ä¸è¯´è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ã€‚</p>
<p><strong>å‚è€ƒè¿æ¥</strong></p>
<p> <a href="https://zhuanlan.zhihu.com/p/37189203" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/37189203</a> </p>
<p> <a href="https://www.cnblogs.com/skyfsm/p/8451834.html" target="_blank" rel="noopener">https://www.cnblogs.com/skyfsm/p/8451834.html</a> </p>
<p> <a href="https://github.com/taki0112/Densenet-Tensorflow" target="_blank" rel="noopener">https://github.com/taki0112/Densenet-Tensorflow</a> </p>
<div><strong>ğŸš©æ¨èé˜…è¯»</strong><ul><li><a href="https://1187100546.github.io/2020/01/14/lenet-5/">Lenet-5å·ç§¯ç¥ç»ç½‘ç»œç»“æ„</a></li><li><a href="http://univeryinli.coding.me/2019/07/03/BERTçš„å‰ä¸–ä»Šç”Ÿ/">BERTçš„å‰ä¸–ä»Šç”Ÿ</a></li><li><a href="http://univeryinli.github.io/2019/07/03/BERTçš„å‰ä¸–ä»Šç”Ÿ/">BERTçš„å‰ä¸–ä»Šç”Ÿ</a></li></ul></div>
        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2020-02-09T08:13:48.517Z" itemprop="dateUpdated">2020-02-09 16:13:48</time>
</span><br>


        
        æ–‡ç« å‘å¸ƒåœ°å€ï¼š<a href="/2020/02/09/densenet/" target="_blank" rel="external">https://1187100546.github.io/2020/02/09/densenet/</a>
        
    </div>
    
    <footer>
        <a href="https://1187100546.github.io">
            <img src="/img/avatar.jpg" alt="huahua">
            huahua
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">èµ</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Deep-Learning/">Deep Learning</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DenseNet/">DenseNet</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ç¥ç»ç½‘ç»œ/">ç¥ç»ç½‘ç»œ</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://1187100546.github.io/2020/02/09/densenet/&title=ã€ŠDenseNetç¥ç»ç½‘ç»œç»“æ„ã€‹ â€” èŠ±èŠ±çš„blog&pic=https://1187100546.github.io/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://1187100546.github.io/2020/02/09/densenet/&title=ã€ŠDenseNetç¥ç»ç½‘ç»œç»“æ„ã€‹ â€” èŠ±èŠ±çš„blog&source=CVPR 2017æœ€ä½³è®ºæ–‡DenseNetï¼Œè®ºæ–‡ä¸­æå‡ºçš„DenseNetï¼ˆDense Convolutional Networkï¼‰ ã€‚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://1187100546.github.io/2020/02/09/densenet/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠDenseNetç¥ç»ç½‘ç»œç»“æ„ã€‹ â€” èŠ±èŠ±çš„blog&url=https://1187100546.github.io/2020/02/09/densenet/&via=https://1187100546.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://1187100546.github.io/2020/02/09/densenet/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2020/03/19/NFC/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">NFC</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/01/14/lenet-5/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Lenet-5å·ç§¯ç¥ç»ç½‘ç»œç»“æ„</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment v" id="vcomments"></div>
    <!-- <div class="comment" id="comment"></div> -->
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script>
    <!-- <script src="//t1.aixinxi.net/o_1c3n4pim01nl3jg91b6l1kjtkvsa.js"></script> -->
    <!-- <script src="/js/Valine.min.js"></script> -->
    <!-- <script src="https://cdnjs.cat.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
    <script src="//cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            av: AV,
            // el: '#comments',
            el: '#vcomments',
            emoticon_url: 'https://abelsu7.top/alu', //è¡¨æƒ…å›¾ç‰‡ç½‘å€
            emoticon_list: ["èµä¸€ä¸ª.png","åç­‰.png","é•¿è‰.png","é˜´æš—.png","é‚ªæ¶.png","å°çœ¼ç›.png","æƒ³ä¸€æƒ³.png","çŒ®é»„ç“œ.png","çŒ®èŠ±.png","å–œæè€Œæ³£.png","æ— è¯­.png","æ— æ‰€è°“.png","æ— å¥ˆ.png","æŠ•é™.png","æ·±æ€.png","æœŸå¾….png","ç‹‚æ±—.png","èœ¡çƒ›.png","çœ‹ä¸è§.png","æƒŠå–œ.png","å‡»æŒ.png","æ¬¢å‘¼.png","å¾—æ„.png","ä¸å‡ºæ‰€æ–™.png","è§‚å¯Ÿ.png"],//è¡¨æƒ…å›¾ç‰‡æ–‡ä»¶å
            // notify: 'false' == 'false',
            // verify: 'false' == 'false',
            // notify: 'false',
            // verify: 'false',
            notify: false,
            verify: false,
            appId: "xOsugK8HFYdHC2hNGosWRjdn-gzGzoHsz",
            appKey: "Azvn66MvIyLs9e2BrEzuWDcC",
            avatar: "mp",
            placeholder: "Write a comment",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        æ„Ÿè°¢æ”¯æŒï¼
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechatpay.png" alt="æ‰“èµäºŒç»´ç ">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechatpay.png" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">å¾®ä¿¡</span>
                <span class="reward-toggle-item switch">åˆ‡æ¢</span>
                <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


            <p>
                
                    <span>
                        <a href="/atom.xml" target="_blank" class="rss" title="rss">
                            <i class="icon icon-lg icon-rss"></i>
                        </a>
                    </span>
                    
                        <span>
                            This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
                        </span>
            </p>
    </div>
    <div class="bottom">
        <p>
            <span>
                huahua &copy;
                    
                        2018 -
                            
                                2020
            </span>
            <span>
                
                        Power by
                        <a href="http://hexo.io/" target="_blank">Hexo</a> Theme
                        <a href="https://github.com/abelsu7/hexo-theme-indigo-plus" target="_blank">indigo plus</a>
                        <p>Hosted by <a href="https://pages.github.com" target="_blank" style="font-weight: bold">Github Pages</a></p>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>
<a href="javascript:;" id="gobottom" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-comments"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://1187100546.github.io/2020/02/09/densenet/&title=ã€ŠDenseNetç¥ç»ç½‘ç»œç»“æ„ã€‹ â€” èŠ±èŠ±çš„blog&pic=https://1187100546.github.io/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://1187100546.github.io/2020/02/09/densenet/&title=ã€ŠDenseNetç¥ç»ç½‘ç»œç»“æ„ã€‹ â€” èŠ±èŠ±çš„blog&source=CVPR 2017æœ€ä½³è®ºæ–‡DenseNetï¼Œè®ºæ–‡ä¸­æå‡ºçš„DenseNetï¼ˆDense Convolutional Networkï¼‰ ã€‚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://1187100546.github.io/2020/02/09/densenet/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠDenseNetç¥ç»ç½‘ç»œç»“æ„ã€‹ â€” èŠ±èŠ±çš„blog&url=https://1187100546.github.io/2020/02/09/densenet/&via=https://1187100546.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://1187100546.github.io/2020/02/09/densenet/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACGklEQVR42u3aW47DMAgF0O5/05kFdJJeIK0U+/grqvLwcSWEMa9XPI63cXbP2f1nT12/5+aBgYHxWMZxOd7vyX854+XLlMwNAwNjH0YSQCfX15NI3vNhzhgYGBhxqM0nXV0ODAwMjLsY1Q1w8mYMDAyMfBObT2vytq/vxTEwMB7IqBbrf3n9lfMNDAyMRzGO4ugdc14/Ww3Z/3wFAwNjaUYe4KqFs1462FsyDAyMHRi9CV2H1GRCeSkt+QUDA2NVRi/MTZ6tlvCiwwkMDIwNGL2DzEmo7R2Unn4FAwNjaUa1WN9LFufb2qh1AwMDY1FGWTxI/qrgPOhjYGCszaimgBPeXYW56J/BwMBYlJED8qDcSyJ778HAwFiVUfANGi/ybWpvaTAwMHZg3BU0eyX+anL5YV0xMDA2YEwSteSYMymoVVs9MDAw1mYkUStvwuilejkjuh8DA2M5xrypq7cQOazQbIGBgbEoo5p+VZu9emG3WsjDwMDYgZGfc+ZFt+r2ePIUBgbGbox50a3c39E6bMDAwNiTMa/YTdLKfA6nT2FgYCzKOIojL5lNjgGqoR8DA2NtxqToX51u7zjz5lYzDAyMxzJ6pa4kcFcXKAdjYGDsyegFvsmW9Ud7cQwMjI0ZOaZX7h/1iWBgYGzPmKSDk/Lchy9iYGBswEg2sXkhrNdm0TsExcDA2IExb7C4ThbzQlu1AIeBgbEB4w+F+0HPCECzUAAAAABJRU5ErkJggg==" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.jsdelivr.net/npm/node-waves@0.7.6/src/js/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<!-- <script async src="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script> -->
<!-- <script async src="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script> -->




<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script src="/js/prism.min.js?v=1.7.2"></script>
<script src="/js/prism-vim.min.js?v=1.7.2"></script>
</body>
</html>
